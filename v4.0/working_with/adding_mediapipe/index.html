
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://illixr.github.io/ILLIXR/latest/working_with/adding_mediapipe/">
      
      
        <link rel="prev" href="../modules/">
      
      
        <link rel="next" href="../display_backend/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>Mediapipe Based Plugins - ILLIXR Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/mkd-extra.css">
    
      <link rel="stylesheet" href="../../css/code-box-copy.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: none; }
    .glightbox-clean .gslide-media {
        -webkit-box-shadow: none;
        box-shadow: none;
    }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#adding-mediapipe-based-plugins" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
You're not viewing the latest version.
<a href="../../..">
    <strong>Click here to go to latest.</strong>
</a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      



<header class="md-header md-header--shadow" data-md-component="header" style="background-color: #11284b">
    <nav class="md-header__inner md-grid" aria-label="Header">
        <a href="../.." title="ILLIXR Documentation" class="md-header__button md-logo" aria-label="ILLIXR Documentation" data-md-component="logo">
            <img src="../../images/icon.png" alt="logo">
        </a>
        <label class="md-header__button md-icon" for="__drawer">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
        </label>
        <div class="md-header__title" data-md-component="header-title">
            <div class="md-header__ellipsis">
                <div class="md-header__topic">
          <span class="md-ellipsis">
            ILLIXR Documentation
          </span>
                </div>
                <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Mediapipe Based Plugins
            
          </span>
                </div>
            </div>
        </div>
        
        
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
        
        
        
        <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
        
        
        
        <label class="md-header__button md-icon" for="__search">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
        
    </nav>
    
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
    <label class="md-nav__title" for="__drawer" style="background-color:var(--md-nav-hdr-color);color:var(--md-nav-hdr-fg-color);">
        <a href="../.." title="ILLIXR Documentation" class="md-nav__button md-logo" aria-label="ILLIXR Documentation" data-md-component="logo">
            <img src="../../images/icon.png" alt="logo">
        </a>
        ILLIXR Documentation
    </label>
    
    <ul class="md-nav__list" data-md-scrollfix style="background-color:var(--md-nav-list-color)">
        
        
        






































<li class="md-nav__item md-nav__item--active md-nav__item--nested">


    
    
    
    <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
    
    
    
    <div class="md-nav__link md-nav__container" style="color:black;">
        <a href="../.." class="md-nav__link ">
            

<span class="md-ellipsis">
    Latest Documentation
    
  </span>


        </a>
        
        
        <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
            <span class="md-nav__icon md-icon"></span>
        </label>
        
    </div>
    
    <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Latest Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
            
            
            
            
            




<li class="md-nav__item">
    <a href="../../getting_started/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Getting Started
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../illixr_plugins/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Plugin Overview
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../illixr_services/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Services Overview
    
  </span>


    </a>
</li>


            
            
            
            
























































<li class="md-nav__item md-nav__item--nested">


    
    
    
    <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5" >
    
    
    <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="0" style="color:black;">
        

<span class="md-ellipsis">
    Plugin/Service Details
    
  </span>


        <span class="md-nav__icon md-icon"></span>
    </label>
    
    <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_5">
            <span class="md-nav__icon md-icon"></span>
            Plugin/Service Details
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_debugview/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Debugview
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_fauxpose/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Fauxpose
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_gldemo/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Gldemo
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_hand_tracking/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Hand Tracking
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_lighthouse/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Lighthouse
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/monado_illixr_runtime_overview/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Monado Overview
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/monado_integration_dataflow/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Monado Dataflow
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_native_renderer/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Native Renderer
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_offload_rendering_client/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Offload Rendering Client
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_offload_rendering_server/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Offload Rendering Server
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_offload_vio/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Offload VIO
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_openni/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    OpenNI
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_openwarp_vk/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Openwarp
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_orb_slam3/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    ORM_SLAM3
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_record_imu_cam/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Record_imu_cam
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_timewarp_gl/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Timewarp_gl
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_timewarp_vk/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Timewarp_VK
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_vkdemo/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Vkdemo
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_webcam/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Webcam
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_zed/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Zed
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/README_zed_data_injection/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Zed Data Injection
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../plugin_README/zed_capture/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Zed Data Capture
    
  </span>


    </a>
</li>


            
            
        </ul>
    </nav>
    
</li>


            
            
            
            


































<li class="md-nav__item md-nav__item--active md-nav__item--nested" style=background-color:var(--md-nav-list-lt-color);">


    
    
    
    <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6" checked>
    
    
    <label class="md-nav__link" for="__nav_1_6" id="__nav_1_6_label" tabindex="0" style="color:black;">
        

<span class="md-ellipsis">
    Working with ILLIXR
    
  </span>


        <span class="md-nav__icon md-icon"></span>
    </label>
    
    <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_1_6">
            <span class="md-nav__icon md-icon"></span>
            Working with ILLIXR
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
            
            
            




<li class="md-nav__item">
    <a href="../modifying_a_plugin/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Modifying a Plugin
    
  </span>


    </a>
</li>


            
            
            
            
















<li class="md-nav__item md-nav__item--nested">


    
    
    
    <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6_2" >
    
    
    <label class="md-nav__link" for="__nav_1_6_2" id="__nav_1_6_2_label" tabindex="0" style="color:black;">
        

<span class="md-ellipsis">
    Writing a Plugin
    
  </span>


        <span class="md-nav__icon md-icon"></span>
    </label>
    
    <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_6_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_6_2">
            <span class="md-nav__icon md-icon"></span>
            Writing a Plugin
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
            
            
            




<li class="md-nav__item">
    <a href="../writing_your_plugin/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Writing Your Plugin
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../modules/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Modules
    
  </span>


    </a>
</li>


            
            
        </ul>
    </nav>
    
</li>


            
            
            
            







<li class="md-nav__item md-nav__item--active" style=background-color:var(--md-nav-list-lt-color);">

    
    <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
    
    
    
    
    
    <a href="./" class="md-nav__link md-nav__link--active" style="color:var(--md-nav-item-active);background-color:var();">
        

<span class="md-ellipsis">
    Mediapipe Based Plugins
    
  </span>


    </a>
    
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../display_backend/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Display Backends
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../logging_and_metrics/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Logging and Metrics
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../updating_tags_and_docs/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Updating Tags and Documentation
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../external_switchboard_and_phonebook/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Using Switchboard and Phonebook Externally
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../virtualization/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    ILLIXR Under Virtualization
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../using_cameras/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Using ILLIXR with Cameras
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../debugging_illixr/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Debugging Tips
    
  </span>


    </a>
</li>


            
            
        </ul>
    </nav>
    
</li>


            
            
            
            


































<li class="md-nav__item md-nav__item--nested">


    
    
    
    <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7" >
    
    
    
    <div class="md-nav__link md-nav__container" style="color:black;">
        <a href="../../contributing/" class="md-nav__link ">
            

<span class="md-ellipsis">
    Contributing to ILLIXR
    
  </span>


        </a>
        
        
        <label class="md-nav__link " for="__nav_1_7" id="__nav_1_7_label" tabindex="0">
            <span class="md-nav__icon md-icon"></span>
        </label>
        
    </div>
    
    <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_7">
            <span class="md-nav__icon md-icon"></span>
            Contributing to ILLIXR
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
            
            
            
            
            




<li class="md-nav__item">
    <a href="../../contributing/code_of_conduct/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Code of Conduct
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../contributing/asking_questions/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Asking Questions
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../contributing/opening_an_issue/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Reporting a Bug
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../contributing/feature_request/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Suggesting a Feature/Improvement
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../contributing/style_guide/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Programming Style Guide
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../contributing/third_party/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Using 3rd Party Code/Libraries
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../contributing/licenses/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Licenses
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../contributing/pull_request/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Creating a Pull Request
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../contributing/code_review/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Code Review Guidelines
    
  </span>


    </a>
</li>


            
            
        </ul>
    </nav>
    
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../glossary/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Glossary
    
  </span>


    </a>
</li>


            
            
            
            


















<li class="md-nav__item md-nav__item--nested">


    
    
    
    <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9" >
    
    
    <label class="md-nav__link" for="__nav_1_9" id="__nav_1_9_label" tabindex="0" style="color:black;">
        

<span class="md-ellipsis">
    API
    
  </span>


        <span class="md-nav__icon md-icon"></span>
    </label>
    
    <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_9">
            <span class="md-nav__icon md-icon"></span>
            API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
            
            
            
















<li class="md-nav__item md-nav__item--nested">


    
    
    
    <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_1" >
    
    
    <label class="md-nav__link" for="__nav_1_9_1" id="__nav_1_9_1_label" tabindex="0" style="color:black;">
        

<span class="md-ellipsis">
    Classes
    
  </span>


        <span class="md-nav__icon md-icon"></span>
    </label>
    
    <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_9_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_9_1">
            <span class="md-nav__icon md-icon"></span>
            Classes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
            
            
            




<li class="md-nav__item">
    <a href="../../api/classes/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Class Index
    
  </span>


    </a>
</li>


            
            
            
            


























<li class="md-nav__item md-nav__item--nested">


    
    
    
    <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_1_2" >
    
    
    <label class="md-nav__link" for="__nav_1_9_1_2" id="__nav_1_9_1_2_label" tabindex="0" style="color:black;">
        

<span class="md-ellipsis">
    System
    
  </span>


        <span class="md-nav__icon md-icon"></span>
    </label>
    
    <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_9_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_9_1_2">
            <span class="md-nav__icon md-icon"></span>
            System
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
            
            
            




<li class="md-nav__item">
    <a href="../../api/classILLIXR_1_1phonebook/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    phonebook
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/classILLIXR_1_1switchboard/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    switchboard
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/classILLIXR_1_1relative__clock/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    relative_clock
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/classILLIXR_1_1plugin/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    plugin
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/classILLIXR_1_1threadloop/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    threadloop
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/classILLIXR_1_1event/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    even
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/classILLIXR_1_1data__format_1_1pose__prediction/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    pose_prediction
    
  </span>


    </a>
</li>


            
            
        </ul>
    </nav>
    
</li>


            
            
        </ul>
    </nav>
    
</li>


            
            
            
            












































<li class="md-nav__item md-nav__item--nested">


    
    
    
    <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_2" >
    
    
    <label class="md-nav__link" for="__nav_1_9_2" id="__nav_1_9_2_label" tabindex="0" style="color:black;">
        

<span class="md-ellipsis">
    Data Structures
    
  </span>


        <span class="md-nav__icon md-icon"></span>
    </label>
    
    <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_9_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_9_2">
            <span class="md-nav__icon md-icon"></span>
            Data Structures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
            
            
            






















<li class="md-nav__item md-nav__item--nested">


    
    
    
    <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_2_1" >
    
    
    <label class="md-nav__link" for="__nav_1_9_2_1" id="__nav_1_9_2_1_label" tabindex="0" style="color:black;">
        

<span class="md-ellipsis">
    Points
    
  </span>


        <span class="md-nav__icon md-icon"></span>
    </label>
    
    <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_9_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_9_2_1">
            <span class="md-nav__icon md-icon"></span>
            Points
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1point/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    point
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1point__with__validity/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    point_with_validity
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1point__with__units/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    point_with_units
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1points__with__units/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    points_with_units
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1raw__point/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    raw_point
    
  </span>


    </a>
</li>


            
            
        </ul>
    </nav>
    
</li>


            
            
            
            


























<li class="md-nav__item md-nav__item--nested">


    
    
    
    <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_2_2" >
    
    
    <label class="md-nav__link" for="__nav_1_9_2_2" id="__nav_1_9_2_2_label" tabindex="0" style="color:black;">
        

<span class="md-ellipsis">
    Camera
    
  </span>


        <span class="md-nav__icon md-icon"></span>
    </label>
    
    <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_9_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_9_2_2">
            <span class="md-nav__icon md-icon"></span>
            Camera
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1cam__base__type/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    cam_base_type
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1monocular__cam__type/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    monocular_cam_type
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1binocular__cam__type/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    binocular_cam_type
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1rgb__depth__type/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    rdb_depth_type
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1cam__type__zed/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    cam_type_zed
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1ccd__data/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    ccd_data
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1camera__data/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    camera_data
    
  </span>


    </a>
</li>


            
            
        </ul>
    </nav>
    
</li>


            
            
            
            






















<li class="md-nav__item md-nav__item--nested">


    
    
    
    <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_2_3" >
    
    
    <label class="md-nav__link" for="__nav_1_9_2_3" id="__nav_1_9_2_3_label" tabindex="0" style="color:black;">
        

<span class="md-ellipsis">
    Pose
    
  </span>


        <span class="md-nav__icon md-icon"></span>
    </label>
    
    <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_9_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_9_2_3">
            <span class="md-nav__icon md-icon"></span>
            Pose
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1pose__data/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    pose_data
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1pose__type/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    pose_type
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1fast__pose__type/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    fast_pose_type
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1raw__pose/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    raw_pose
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1texture__pose/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    texture_pose
    
  </span>


    </a>
</li>


            
            
        </ul>
    </nav>
    
</li>


            
            
            
            




















<li class="md-nav__item md-nav__item--nested">


    
    
    
    <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_2_4" >
    
    
    <label class="md-nav__link" for="__nav_1_9_2_4" id="__nav_1_9_2_4_label" tabindex="0" style="color:black;">
        

<span class="md-ellipsis">
    IMU
    
  </span>


        <span class="md-nav__icon md-icon"></span>
    </label>
    
    <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_9_2_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_9_2_4">
            <span class="md-nav__icon md-icon"></span>
            IMU
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1imu__params/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    imu_params
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1imu__type/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    imu_type
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1imu__integrator__input/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    imu_integrator_input
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1imu__raw__type/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    imu_raw_type
    
  </span>


    </a>
</li>


            
            
        </ul>
    </nav>
    
</li>


            
            
            
            
























<li class="md-nav__item md-nav__item--nested">


    
    
    
    <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9_2_5" >
    
    
    <label class="md-nav__link" for="__nav_1_9_2_5" id="__nav_1_9_2_5_label" tabindex="0" style="color:black;">
        

<span class="md-ellipsis">
    Hands
    
  </span>


        <span class="md-nav__icon md-icon"></span>
    </label>
    
    <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_1_9_2_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_9_2_5">
            <span class="md-nav__icon md-icon"></span>
            Hands
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1ht_1_1hand__points/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    hand_points
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1ht_1_1ht__detection/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    ht_detection
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1ht_1_1position/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    position
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1ht_1_1velocity/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    velocity
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1ht_1_1ht__frame/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    ht_frame
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1ht_1_1raw__ht__data/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    raw_ht_data
    
  </span>


    </a>
</li>


            
            
        </ul>
    </nav>
    
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1compressed__frame/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    compressed_frame
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1connection__signal/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    connection_signal
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1depth__type/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    depth_type
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1hmd__physical__info/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    hmd_physical_info
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1hologram__input/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    hologram_input
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1image__handle/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    image_handle
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/classILLIXR_1_1data__format_1_1proper__quaternion/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    proper_quaternion
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1rect/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    rect
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1rendered__frame/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    rendered_frame
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1signal__to__quad/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    signal_to_quad
    
  </span>


    </a>
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/structILLIXR_1_1data__format_1_1vk__image__handle/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    vk_image_handle
    
  </span>


    </a>
</li>


            
            
        </ul>
    </nav>
    
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../api/namespaces/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Namespaces
    
  </span>


    </a>
</li>


            
            
        </ul>
    </nav>
    
</li>


            
            
            
            




<li class="md-nav__item">
    <a href="../../LICENSE/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    License
    
  </span>


    </a>
</li>


            
            
            
            














<li class="md-nav__item md-nav__item--nested">


    
    
    
    <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_11" >
    
    
    <label class="md-nav__link" for="__nav_1_11" id="__nav_1_11_label" tabindex="0" style="color:black;">
        

<span class="md-ellipsis">
    Policies
    
  </span>


        <span class="md-nav__icon md-icon"></span>
    </label>
    
    <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_11">
            <span class="md-nav__icon md-icon"></span>
            Policies
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
            
            
            




<li class="md-nav__item">
    <a href="../../policies/branch_retention/" class="md-nav__link" style="color:black;">
        

<span class="md-ellipsis">
    Branch Retention
    
  </span>


    </a>
</li>


            
            
        </ul>
    </nav>
    
</li>


            
            
        </ul>
    </nav>
    
</li>


        
    </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
    
    
    
    
    
    
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="adding-mediapipe-based-plugins">Adding Mediapipe Based Plugins</h1>
<p>There are several tools from <a href="https://ai.google.dev/edge/mediapipe/solutions/guide">Mediapipe</a> which a may be of use to the ILLIXR project as a plugin. This page documents
the process for converting these tools to plugins, following the experience of converting the hand landmark detection
tool.</p>
<h1 id="steps">Steps</h1>
<ol>
<li><a href="#clone-the-repo">Clone the repo</a></li>
<li><a href="#find-the-root-file">Find the root file</a></li>
<li><a href="#understanding-bazel-build-files">Understanding bazel BUILD files</a><ul>
<li><a href="#select-statements">Select Statements</a></li>
<li><a href="#example-descriptors">Descriptors</a><ul>
<li><a href="#binary-executable">Binary</a></li>
<li><a href="#library-component">Library</a></li>
<li><a href="#protobuf-library-component">Protobuf</a></li>
<li><a href="#pbtxt-files">Pbtxt</a></li>
<li><a href="#external-library">External Libraries</a></li>
<li><a href="#individual-file">Data Files</a></li>
</ul>
</li>
<li><a href="#parsing-the-dependencies">Parsing Dependencies</a><ul>
<li><a href="#local">Local</a></li>
<li><a href="#in-another-file">In another file</a></li>
<li><a href="#external">External</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#find-the-necessary-code-files">Find the necessary code files</a><ul>
<li><a href="#c">C++</a></li>
<li><a href="#protobuf">Protobuf</a></li>
<li><a href="#pbtxt">Pbtxt</a></li>
<li><a href="#data">Data</a></li>
<li><a href="#move-the-files">Move the Files</a></li>
</ul>
</li>
<li><a href="#package-dependencies">Package Dependencies</a><ul>
<li><a href="#common">Common</a></li>
<li><a href="#custom">Custom</a></li>
</ul>
</li>
<li><a href="#plugin-cmakeliststxt">Plugin CMakeLists.txt</a><ul>
<li><a href="#header">Header</a></li>
<li><a href="#command-line-options">Command Line Options</a></li>
<li><a href="#cmake_module_path">CMAKE_MODULE_PATH</a></li>
<li><a href="#dependencies">Dependencies</a></li>
<li><a href="#protobuf-helpers">Protobuf Helpers</a></li>
<li><a href="#special-operations">Special Operations</a></li>
<li><a href="#the-plugin-itself">The Plugin Itself</a></li>
</ul>
</li>
<li><a href="#adapting-the-tool-for-illixr">Adapting the Tool for ILLIXR</a><ul>
<li><a href="#protobufcmake-files">protobuf.cmake Files</a></li>
<li><a href="#buildcmake-files">build.cmake Files</a></li>
<li><a href="#handling-pbtxt-files">Handling pbtxt Files</a></li>
</ul>
</li>
<li><a href="#writing-your-plugin">Writing Your Plugin</a><ul>
<li><a href="#understanding-graph-files">Understanding Graph Files</a></li>
<li><a href="#sending-data-to-the-tool">Sending Data to the Tool</a></li>
<li><a href="#getting-data-from-the-tool">Getting Data From the Tool</a></li>
<li><a href="#adding-a-calculator">Adding a Calculator</a><ul>
<li><a href="#changing-graph-files">Changing Graph Files</a></li>
<li><a href="#data-structures">Data Structures</a></li>
<li><a href="#calculator-code">Calculator Code</a><ul>
<li><a href="#common-function-calls">Common Function Calls</a></li>
<li><a href="#getcontract">GetContract</a></li>
<li><a href="#open">Open</a></li>
<li><a href="#process">Process</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#pluginhpp">plugin.hpp</a></li>
<li><a href="#plugincpp">plugin.cpp</a><ul>
<li><a href="#input">Input</a></li>
<li><a href="#publisher">Publisher</a></li>
</ul>
</li>
<li><a href="#cmakeliststxt">CMakeLists.txt</a></li>
</ul>
</li>
</ol>
<h2 id="clone-the-repo">Clone the repo</h2>
<p>These tools are provided by Mediapipe in a single git repo (https://github.com/google-ai-edge/mediapipe.git). So clone
the repo to your workspace. Since these tools share a number of dependencies and components in some cases it is best for
all the wrapped tool to come from the same version of the Mediapipe codebase (currently v0.10.14).</p>
<div class="language-bash copy highlight"><pre><span></span><code><span id="__span-0-1">git<span class="w"> </span>clone<span class="w"> </span>https://github.com/google-ai-edge/mediapipe.git
</span><span id="__span-0-2">git<span class="w"> </span>checkout<span class="w"> </span>v0.10.14
</span></code></pre></div>
<p>or</p>
<div class="language-bash copy highlight"><pre><span></span><code><span id="__span-1-1">wget<span class="w"> </span>https://github.com/google-ai-edge/mediapipe/archive/refs/tags/v0.10.14.tar.gz
</span><span id="__span-1-2">tar<span class="w"> </span>xf<span class="w"> </span>v0.10.14.tar.gz
</span></code></pre></div>
<p>For purposes of this tutorial the term <code>file root</code> will refer to the root directory of the clone or unpacked tarball.</p>
<h2 id="find-the-root-file">Find the root file</h2>
<p>Mediapipe tools use the bazel build system which is not compatible with the CMake build system ILLIXR uses. The bazel
build system relies on files named BUILD and WORKSPACE as the primary building blocks to define what is to be built. You
will need to locate the BUILD file associated with the tool you want to work with. These are located in
mediapipe/example/desktop/<tool name>. For example the hand tracking BUILD file is
mediapipe/examples/desktop/hand_tracking/BUILD</p>
<h2 id="understanding-bazel-build-files">Understanding bazel BUILD files</h2>
<p>Bazel BUILD (and WORKSPACE) files are written in a dialect of Python called <a href="https://github.com/bazelbuild/starlark">Starlark</a>. Most of the content of these
files describe libraries and binaries which can be built, similar to a <a href="https://cmake.org/cmake/help/book/mastering-cmake/chapter/Key%20Concepts.html#targets">TARGET</a> in Cmake. Unlike CMake where most
TARGETS are complete libraries or binaries with numerous source files, libraries and binaries in bazel typically have
a few, or only one source file. Each of these items also has a list of other items that it depends on. Thus, starting
with the main binary descriptor, you can walk your way through each of the dependencies to find all source files that
are needed. A bazel project may consist of hundreds, or even thousands, of individual libraries, described in dozens of
files scattered around the source tree.</p>
<p>There are only a few object types we need to concern ourselves with for wrapping a tool.</p>
<ul>
<li><strong>cc_binary</strong>: describes what is needed to build an executable</li>
<li><strong>cc_library</strong>: describes what is needed to build a library component (usually produces a single object file)</li>
<li><strong>cc_library_with_tflite</strong>: specialized version of cc_library which links to tensorflow lite components</li>
<li><strong>mediapipe_proto_library</strong>: describes what is needed to build a library component from a protobuf file</li>
<li><strong>http_archive</strong>: describes where to find and build an external library, similar to CMake's ExternalProject or
  Fetchcontent functionality</li>
<li><strong>mediapipe_simple_subgraph</strong>: describes a workflow, or sub-workflow, for a tool</li>
<li><strong>http_file</strong>: describes where to find a single file on the web, typically a precompiled data file</li>
</ul>
<h3 id="select-statements">Select Statements</h3>
<p>In the bazel build system the keyword <code>select</code> is used to denote an if/then/else syntax when constructing a list of
source files or dependencies. The syntax is similar to a python dictionary where each key is a condition to test, and
the value is a list of descriptors to include in whatever list the select statement is attached to. The
<code>//conditions:default</code> is used to indicate what to use if none of the other options are true. For example</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><span class="n">deps</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-2-2">   <span class="s2">&quot;inference_calculator_cpu&quot;</span>
</span><span id="__span-2-3"><span class="p">]</span> <span class="o">+</span> <span class="n">select</span><span class="p">({</span>
</span><span id="__span-2-4">   <span class="s2">&quot;//conditions:default&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;infer_calc_gl&quot;</span><span class="p">,</span> <span class="s2">&quot;infer_shader&quot;</span><span class="p">],</span>
</span><span id="__span-2-5">   <span class="s2">&quot;:platform_apple&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;infer_calc_metal&quot;</span><span class="p">],</span>
</span><span id="__span-2-6"><span class="p">})</span>
</span></code></pre></div>
<p>This statement would add the infer_calc_metal descriptor to the deps list if the build platform is apple, otherwise the
infer_calc_gl and infer_shader are added. When these statements are encountered you will need to decide which
descriptors need to be added to the appropriate list. In some instances you may need to set up similar logic in CMake
syntax (e.g. include certain files if OpenCV is detected).</p>
<h3 id="example-descriptors">Example Descriptors</h3>
<h4 id="binary-executable">Binary (executable)</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><span class="n">cc_binary</span><span class="p">(</span>
</span><span id="__span-3-2">    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;hand_tracking_cpu&quot;</span><span class="p">,</span>
</span><span id="__span-3-3">    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-3-4">        <span class="s2">&quot;//mediapipe/modules/hand_landmark:hand_landmark_full.tflite&quot;</span><span class="p">,</span>
</span><span id="__span-3-5">        <span class="s2">&quot;//mediapipe/modules/palm_detection:palm_detection_full.tflite&quot;</span><span class="p">,</span>
</span><span id="__span-3-6">    <span class="p">],</span>
</span><span id="__span-3-7">    <span class="n">deps</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-3-8">        <span class="s2">&quot;//mediapipe/examples/desktop:demo_run_graph_main&quot;</span><span class="p">,</span>
</span><span id="__span-3-9">        <span class="s2">&quot;//mediapipe/graphs/hand_tracking:desktop_tflite_calculators&quot;</span><span class="p">,</span>
</span><span id="__span-3-10">    <span class="p">],</span>
</span><span id="__span-3-11"><span class="p">)</span>
</span></code></pre></div>
<ul>
<li><strong>name</strong>: the name of the executable to be built</li>
<li><strong>data</strong>: data files which are used by the executable; these files can be downloaded from the web, and in CMake we
  treat them like a source file</li>
<li><strong>deps</strong>: dependencies that this binary has</li>
</ul>
<p>!!!! note</p>
<div class="language-text highlight"><pre><span></span><code> The cc_binary descriptor does not give any source files, all source files come from the dependency listings.
</code></pre></div>
<h4 id="library-component">Library component</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><span class="n">cc_library</span><span class="p">(</span>
</span><span id="__span-4-2">   <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;landmarks_to_render_data_calculator&quot;</span><span class="p">,</span>
</span><span id="__span-4-3">   <span class="n">srcs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;landmarks_to_render_data_calculator.cc&quot;</span><span class="p">],</span>
</span><span id="__span-4-4">   <span class="n">hdrs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;landmarks_to_render_data_calculator.h&quot;</span><span class="p">],</span>
</span><span id="__span-4-5">   <span class="n">deps</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-4-6">      <span class="s2">&quot;:landmarks_to_render_data_calculator_cc_proto&quot;</span><span class="p">,</span>
</span><span id="__span-4-7">      <span class="s2">&quot;//mediapipe/framework:calculator_framework&quot;</span><span class="p">,</span>
</span><span id="__span-4-8">      <span class="s2">&quot;//mediapipe/framework:calculator_options_cc_proto&quot;</span><span class="p">,</span>
</span><span id="__span-4-9">      <span class="s2">&quot;//mediapipe/framework/formats:landmark_cc_proto&quot;</span><span class="p">,</span>
</span><span id="__span-4-10">      <span class="s2">&quot;//mediapipe/framework/formats:location_data_cc_proto&quot;</span><span class="p">,</span>
</span><span id="__span-4-11">      <span class="s2">&quot;//mediapipe/framework/port:ret_check&quot;</span><span class="p">,</span>
</span><span id="__span-4-12">      <span class="s2">&quot;//mediapipe/util:color_cc_proto&quot;</span><span class="p">,</span>
</span><span id="__span-4-13">      <span class="s2">&quot;//mediapipe/util:render_data_cc_proto&quot;</span><span class="p">,</span>
</span><span id="__span-4-14">      <span class="s2">&quot;@com_google_absl//absl/memory&quot;</span><span class="p">,</span>
</span><span id="__span-4-15">      <span class="s2">&quot;@com_google_absl//absl/strings&quot;</span><span class="p">,</span>
</span><span id="__span-4-16">   <span class="p">],</span>
</span><span id="__span-4-17">   <span class="n">alwayslink</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-4-18"><span class="p">)</span>
</span></code></pre></div>
<ul>
<li><strong>name</strong>: name of the library component (think of it like a TARGET in CMake)</li>
<li><strong>srcs</strong>: list of source files for this component</li>
<li><strong>hdrs</strong>: list of header files for this component</li>
<li><strong>deps</strong>: list of dependencies for this component (think of them as libraries to link against)</li>
</ul>
<p>Both the <strong>src</strong> and <strong>hdrs</strong> are optional, and often only one is present in a descriptor. The <code>alwayslink</code> and
<code>visibility</code> items can be safely ignored.</p>
<h4 id="protobuf-library-component">Protobuf library component</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><span class="n">mediapipe_proto_library</span><span class="p">(</span>
</span><span id="__span-5-2">    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;annotation_overlay_calculator_proto&quot;</span><span class="p">,</span>
</span><span id="__span-5-3">    <span class="n">srcs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;annotation_overlay_calculator.proto&quot;</span><span class="p">],</span>
</span><span id="__span-5-4">    <span class="n">deps</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-5-5">        <span class="s2">&quot;//mediapipe/framework:calculator_options_proto&quot;</span><span class="p">,</span>
</span><span id="__span-5-6">        <span class="s2">&quot;//mediapipe/framework:calculator_proto&quot;</span><span class="p">,</span>
</span><span id="__span-5-7">        <span class="s2">&quot;//mediapipe/util:color_proto&quot;</span><span class="p">,</span>
</span><span id="__span-5-8">    <span class="p">],</span>
</span><span id="__span-5-9"><span class="p">)</span>
</span></code></pre></div>
<ul>
<li><strong>name</strong>: name of the library component (think of it like a TARGET in CMake)</li>
<li><strong>srcs</strong>: list of protobuf source files for this component</li>
<li><strong>deps</strong>: list of dependencies for this component (think of them a libraries to link against)</li>
</ul>
<h4 id="pbtxt-files">Pbtxt Files</h4>
<p>There are two signatures for this type of file.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><span class="n">mediapipe_simple_subgraph</span><span class="p">(</span>
</span><span id="__span-6-2">    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;hand_landmark_model_loader&quot;</span><span class="p">,</span>
</span><span id="__span-6-3">    <span class="n">graph</span> <span class="o">=</span> <span class="s2">&quot;hand_landmark_model_loader.pbtxt&quot;</span><span class="p">,</span>
</span><span id="__span-6-4">    <span class="n">register_as</span> <span class="o">=</span> <span class="s2">&quot;HandLandmarkModelLoader&quot;</span><span class="p">,</span>
</span><span id="__span-6-5">    <span class="n">deps</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-6-6">        <span class="s2">&quot;//mediapipe/calculators/core:constant_side_packet_calculator&quot;</span><span class="p">,</span>
</span><span id="__span-6-7">        <span class="s2">&quot;//mediapipe/calculators/tflite:tflite_model_calculator&quot;</span><span class="p">,</span>
</span><span id="__span-6-8">        <span class="s2">&quot;//mediapipe/calculators/util:local_file_contents_calculator&quot;</span><span class="p">,</span>
</span><span id="__span-6-9">        <span class="s2">&quot;//mediapipe/framework/tool:switch_container&quot;</span><span class="p">,</span>
</span><span id="__span-6-10">    <span class="p">],</span>
</span><span id="__span-6-11"><span class="p">)</span>
</span></code></pre></div>
<ul>
<li><strong>name</strong>: name of the component</li>
<li><strong>graph</strong>: the name of the file that describes the graph</li>
<li><strong>register_as</strong>: alias for the component name</li>
<li><strong>deps</strong>: list of dependencies for this component</li>
</ul>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><span class="n">mediapipe_binary_graph</span><span class="p">(</span>
</span><span id="__span-7-2">    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;hand_tracking_desktop_live_binary_graph&quot;</span><span class="p">,</span>
</span><span id="__span-7-3">    <span class="n">graph</span> <span class="o">=</span> <span class="s2">&quot;hand_tracking_desktop_live.pbtxt&quot;</span><span class="p">,</span>
</span><span id="__span-7-4">    <span class="n">output_name</span> <span class="o">=</span> <span class="s2">&quot;hand_tracking_desktop_live.binarypb&quot;</span><span class="p">,</span>
</span><span id="__span-7-5">    <span class="n">deps</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;:desktop_tflite_calculators&quot;</span><span class="p">],</span>
</span><span id="__span-7-6"><span class="p">)</span>
</span></code></pre></div>
<ul>
<li><strong>name</strong>: name of the component</li>
<li><strong>graph</strong>: the name of the file that describes the graph</li>
<li><strong>output_name</strong>: name of the output files after processing</li>
<li><strong>deps</strong>: list of dependencies for this component</li>
</ul>
<h4 id="external-library">External library</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><span class="c1"># Load Zlib before initializing TensorFlow and the iOS build rules to guarantee</span>
</span><span id="__span-8-2"><span class="c1"># that the target @zlib//:mini_zlib is available</span>
</span><span id="__span-8-3"><span class="n">http_archive</span><span class="p">(</span>
</span><span id="__span-8-4">    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;zlib&quot;</span><span class="p">,</span>
</span><span id="__span-8-5">    <span class="n">build_file</span> <span class="o">=</span> <span class="s2">&quot;@//third_party:zlib.BUILD&quot;</span><span class="p">,</span>
</span><span id="__span-8-6">    <span class="n">sha256</span> <span class="o">=</span> <span class="s2">&quot;b3a24de97a8fdbc835b9833169501030b8977031bcb54b3b3ac13740f846ab30&quot;</span><span class="p">,</span>
</span><span id="__span-8-7">    <span class="n">strip_prefix</span> <span class="o">=</span> <span class="s2">&quot;zlib-1.2.13&quot;</span><span class="p">,</span>
</span><span id="__span-8-8">    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;http://zlib.net/fossils/zlib-1.2.13.tar.gz&quot;</span><span class="p">,</span>
</span><span id="__span-8-9">    <span class="n">patches</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-8-10">        <span class="s2">&quot;@//third_party:zlib.diff&quot;</span><span class="p">,</span>
</span><span id="__span-8-11">    <span class="p">],</span>
</span><span id="__span-8-12">    <span class="n">patch_args</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-8-13">        <span class="s2">&quot;-p1&quot;</span><span class="p">,</span>
</span><span id="__span-8-14">    <span class="p">],</span>
</span><span id="__span-8-15"><span class="p">)</span>
</span></code></pre></div>
<ul>
<li><strong>name</strong>: name of the external package</li>
<li><strong>build_file</strong>: the location of the build file for the package</li>
<li><strong>sha256</strong>: hash to check the integrity of the downloaded file</li>
<li><strong>url</strong>: the full url of the package sources</li>
<li><strong>patches</strong>: any patch files to be applied</li>
<li><strong>patch_args</strong>: any additional command line arguments to send to the patch command</li>
</ul>
<h4 id="individual-file">Individual file</h4>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><span class="n">http_file</span><span class="p">(</span>
</span><span id="__span-9-2">    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;com_google_mediapipe_hand_landmark_full_tflite&quot;</span><span class="p">,</span>
</span><span id="__span-9-3">    <span class="n">sha256</span> <span class="o">=</span> <span class="s2">&quot;11c272b891e1a99ab034208e23937a8008388cf11ed2a9d776ed3d01d0ba00e3&quot;</span><span class="p">,</span>
</span><span id="__span-9-4">    <span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;https://storage.googleapis.com/mediapipe-assets/hand_landmark_full.tflite?generation=1661875760968579&quot;</span><span class="p">],</span>
</span><span id="__span-9-5"><span class="p">)</span>
</span></code></pre></div>
<ul>
<li><strong>name</strong>: name of the file description (for internal reference, is not necessarily the name of the actual file)</li>
<li><strong>sha256</strong>: hash to check the integrity of the downloaded file</li>
<li><strong>urls</strong>: list of urls where the file can be downloaded from</li>
</ul>
<h3 id="parsing-the-dependencies">Parsing the dependencies</h3>
<p>As you may have noted, there are numerous formats that a <strong>dep</strong> entry can take. Let's take a look at them, so we can
understand what they are saying.</p>
<h4 id="local">Local</h4>
<p>Local dependencies are those which are described in the same BUILD file in which they are referenced. For example, in
the <code>cc_library</code> descriptor above, the first <strong>dep</strong> is local. It starts with a <code>:</code>, followed by a name</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-10-1">:landmarks_to_render_data_calculator_cc_proto
</span></code></pre></div>
<p>This means that there is a descriptor in this file with the name <code>landmarks_to_render_data_calculator_cc_proto</code>, and it
is a dependency of <code>landmarks_to_render_data_calculator</code>.</p>
<h4 id="in-another-file">In another file</h4>
<p>Most of the dependencies in the <code>cc_library</code> example are described in other BUILD files. These entries start with <code>//</code>
and have the following format</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-11-1">//&lt;path to build file&gt;:&lt;name of the dependency in that file&gt;
</span></code></pre></div>
<p>So in the second dependency in the <code>cc_library</code> example (<code>//mediapipe/framework:calculator_framework</code>), the descriptor
is named <code>calculator_framework</code> and can be found in <code>mediapipe/framework/BUILD</code> (relative to the file root). The
<a href="#local">Local</a> dependency format is really a specialized version of this format, where the path to the build file is
absent, indicating the current file.</p>
<h4 id="external">External</h4>
<p>The remaining dependencies come from external libraries, this is really a list of libraries to link against, but which
are also built along with this code. The entries start with <code>@</code> followed by the name of the external package, followed
by the library path and name. So, <code>@com_google_absl//absl/memory</code> refers to the absl memory library described by an
<code>http_archive</code> object with the name <code>com_google_absl</code>. As we refactor the code, and the build structure these types of
references will be converted to something like</p>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-12-1"><span class="nb">target_link_library</span><span class="p">(</span><span class="s">landmarks_to_render_data_calculator</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="s">absl::memory</span><span class="p">)</span>
</span></code></pre></div>
<h2 id="find-the-necessary-code-files">Find the necessary code files</h2>
<p>Now that we have a handle on the basic structure of the files we will be going through, we can start to construct a list
of the files we actually need to build our tool. Starting with the dependencies in the <code>cc_binary</code> descriptor we will
need to locate each dependency, then find all of their dependencies, and so on until the only descriptors left have
no internal dependencies (external ones are ok, as these libraries will be built beforehand and do not contribute source
files).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some objects will be the dependency of many other objects.</p>
</div>
<h3 id="c">C++</h3>
<p>Create a list of every <strong>src</strong> and <strong>hdr</strong> file found in each descriptor.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The descriptors only give the file name, you will need to add the path to each of these items, so we can keep track of them. </p>
</div>
<h3 id="protobuf">Protobuf</h3>
<p>Create a separate list of the source files of the <code>mediapipe_proto_library</code> items you need.</p>
<h3 id="pbtxt">Pbtxt</h3>
<p>Create a list of all files listed in graph elements of <code>mediapipe_simple_subgraph</code> items you need. Additionally, keep a
list of all the dependencies for each of these, including the dependencies of those dependencies.</p>
<h3 id="data">Data</h3>
<p>Create a list of all data files that are listed in any descriptors. These are mainly tflite files.</p>
<h3 id="move-the-files">Move the Files</h3>
<p>Now that you have a list of the necessary file to build the tool you should create a separate GitHub repository for your
plugin. Once that is done, create files and directories in the repo as follows:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1">&lt;root<span class="w"> </span>directory&gt;
</span><span id="__span-13-2"><span class="w"> </span>CMakeLists.txt<span class="w">      </span><span class="c1"># Main cmake file</span>
</span><span id="__span-13-3"><span class="w"> </span>cmake<span class="w">               </span><span class="c1"># empty directory for cmake helper files</span>
</span><span id="__span-13-4"><span class="w"> </span>mediapipe<span class="w">           </span><span class="c1"># empty directory to hold all the mediapipe files</span>
</span><span id="__span-13-5"><span class="w"> </span>plugin.cpp<span class="w">          </span><span class="c1"># main plugin code file</span>
</span><span id="__span-13-6"><span class="w"> </span>plugin.hpp<span class="w">          </span><span class="c1"># plugion header file</span>
</span></code></pre></div>
<p>Copy/move all the needed files from your <strong>src</strong>, <strong>hdr</strong>, <strong>protobuf</strong>, <strong>pbtxt</strong>, and <strong>data</strong> file lists into the
<code>mediapipe</code> directory, maintaining their relative paths.
You should also create CMakeLists.txt and protobuf.cmake files in the mediapipe directory. Additionally, you should
copy <a href="https://github.com/ILLIXR/hand_tracking/blob/main/cmake/encoder.cmake">encoder.cmake</a>, <a href="https://github.com/ILLIXR/hand_tracking/blob/main/cmake/make_pb_binary.cmake">make_pb_binary.cmake</a>, and <a href="https://github.com/ILLIXR/hand_tracking/blob/main/cmake/protoc_generate_obj.cmake">protoc_generate_obj.cmake</a> from the ILLIXR hand tracking
repository. These files contain helper functions for processing the protobuf files and should go in a directory called
<code>cmake</code>. Now you should have a directory structure something like this:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1">&lt;root<span class="w"> </span>directory&gt;
</span><span id="__span-14-2"><span class="w"> </span>CMakeLists.txt<span class="w">      </span><span class="c1"># Main cmake file</span>
</span><span id="__span-14-3"><span class="w"> </span>cmake
</span><span id="__span-14-4"><span class="w">   </span><span class="w"> </span>encoder.cmake
</span><span id="__span-14-5"><span class="w">   </span><span class="w"> </span>make_pb_binary.cmake
</span><span id="__span-14-6"><span class="w">   </span><span class="w"> </span>protoc_generate_obj.cmake
</span><span id="__span-14-7"><span class="w"> </span>mediapipe<span class="w">           </span>
</span><span id="__span-14-8"><span class="w">   </span><span class="w"> </span>calculators
</span><span id="__span-14-9"><span class="w">   </span><span class="w"> </span>example
</span><span id="__span-14-10"><span class="w">   </span><span class="w"> </span>framework
</span><span id="__span-14-11"><span class="w">   </span><span class="w"> </span>gpu
</span><span id="__span-14-12"><span class="w">   </span><span class="w"> </span>graphs
</span><span id="__span-14-13"><span class="w">   </span><span class="w"> </span>module
</span><span id="__span-14-14"><span class="w">   </span><span class="w"> </span>utils
</span><span id="__span-14-15"><span class="w"> </span>plugin.cpp<span class="w">          </span><span class="c1"># main plugin code file</span>
</span><span id="__span-14-16"><span class="w"> </span>plugin.hpp<span class="w">          </span><span class="c1"># plugion header file</span>
</span></code></pre></div>
<h2 id="package-dependencies">Package Dependencies</h2>
<h3 id="common">Common</h3>
<p>Common dependencies are those that can be via OS package managers, like boost. There is generally no need to install
these directly. We will just add them as <code>find_package</code> commands in the CMakeLists.txt file. There are however,
exceptions to this rule. An example of this is the Protobuf package. The Mediapipe package requires a Protobuf version
of at least 3.19, which may not be directly available on all OS versions. In this case, the dependency should be treated
like a <a href="#custom">Custom</a> dependency.</p>
<h3 id="custom">Custom</h3>
<p>Custom dependencies are those which are not readily available via OS package managers, or a specific version which
cannot be installed this way. In these cases will add some code to the CMakeLists.txt file to make sure the dependency
is met. The CMakeLists.txt should first do a version check (in case the needed version already exists on the system),
and then download and install the needed version if required. Below is an example for the Protobuf package</p>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-15-1"><span class="nb">find_package</span><span class="p">(</span><span class="s">protobuf</span><span class="w"> </span><span class="s">3.19</span><span class="w"> </span><span class="s">QUIET</span><span class="w"> </span><span class="s">CONFIG</span><span class="p">)</span>
</span><span id="__span-15-2"><span class="nb">if</span><span class="p">(</span><span class="s">protobuf_FOUND</span><span class="p">)</span>
</span><span id="__span-15-3"><span class="w">   </span><span class="nb">report_found</span><span class="p">(</span><span class="s">protobuf</span><span class="w"> </span><span class="s2">&quot;${protobuf_VERSION}&quot;</span><span class="p">)</span>
</span><span id="__span-15-4"><span class="nb">else</span><span class="p">()</span>
</span><span id="__span-15-5"><span class="w">   </span><span class="nb">ExternalProject_Add</span><span class="p">(</span>
</span><span id="__span-15-6"><span class="w">           </span><span class="s">protobuf</span>
</span><span id="__span-15-7"><span class="w">           </span><span class="s">GIT_REPOSITORY</span><span class="w"> </span><span class="s">https://github.com/protocolbuffers/protobuf.git</span>
</span><span id="__span-15-8"><span class="w">           </span><span class="s">GIT_TAG</span><span class="w"> </span><span class="s">v3.19.1</span>
</span><span id="__span-15-9"><span class="w">           </span><span class="s">GIT_PROGRESS</span><span class="w"> </span><span class="s">TRUE</span>
</span><span id="__span-15-10"><span class="w">           </span><span class="s">PREFIX</span><span class="w"> </span><span class="s2">&quot;${CMAKE_BINARY_DIR}/protobuf&quot;</span>
</span><span id="__span-15-11"><span class="w">           </span><span class="s">DOWNLOAD_EXTRACT_TIMESTAMP</span><span class="w"> </span><span class="s">TRUE</span>
</span><span id="__span-15-12"><span class="w">           </span><span class="s">CMAKE_ARGS</span><span class="w"> </span><span class="s">-DCMAKE_INSTALL_PREFIX=</span><span class="o">${</span><span class="nv">CMAKE_INSTALL_PREFIX</span><span class="o">}</span><span class="w"> </span><span class="s">-DCMAKE_BUILD_TYPE=</span><span class="o">${</span><span class="nv">CMAKE_BUILD_TYPE</span><span class="o">}</span><span class="w"> </span><span class="s">-DCMAKE_CXX_FLAGS=</span><span class="s2">&quot;-fPIC&quot;</span>
</span><span id="__span-15-13"><span class="w">           </span><span class="s">SOURCE_SUBDIR</span><span class="w"> </span><span class="s">cmake</span>
</span><span id="__span-15-14"><span class="w">           </span><span class="s">GIT_SUBMODULES_RECURSE</span><span class="w"> </span><span class="s">TRUE</span>
</span><span id="__span-15-15"><span class="w">   </span><span class="p">)</span>
</span><span id="__span-15-16"><span class="nb">endif</span><span class="p">()</span>
</span></code></pre></div>
<p>As with the Hand Tracking plugin, there will likely be a good number of external package dependencies. So that all of
the <code>find_package</code> calls in the plugin work as expected, a separate <a href="https://github.com/ILLIXR/hand_tracking_dependencies">repo</a> was created. This allows for the
dependencies to be built and installed before the plugin tries to find its dependencies. You may need a similar
mechanism for your tool (or even just use the hand tracking one)</p>
<h2 id="plugin-cmakeliststxt">Plugin CMakeLists.txt</h2>
<p>In this section we will use the adaption of the Hand Tracking tool as an example. This file will be presented in
sections below.</p>
<h3 id="header">Header</h3>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-16-1"><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.22</span><span class="p">)</span>
</span><span id="__span-16-2"><span class="nb">project</span><span class="p">(</span><span class="s">ILLIXR_hand_tracking</span><span class="p">)</span>
</span><span id="__span-16-3"><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_VERBOSE_MAKEFILE</span><span class="w"> </span><span class="s">True</span><span class="p">)</span>
</span><span id="__span-16-4"><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_POSITION_INDEPENDENT_CODE</span><span class="w"> </span><span class="s">ON</span><span class="p">)</span>
</span><span id="__span-16-5"><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_PREFIX_PATH</span><span class="w"> </span><span class="s2">&quot;${CMAKE_INSTALL_PREFIX}/lib/cmake&quot;</span><span class="p">)</span>
</span><span id="__span-16-6"><span class="nb">set</span><span class="p">(</span><span class="s">ENV{PKG_CONFIG_PATH}</span><span class="w"> </span><span class="s2">&quot;${CMAKE_INSTALL_PREFIX}/lib/pkgconfig&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>Here the name of the plugin/project is declared along with some global variables.</p>
<h3 id="command-line-options">Command Line Options</h3>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-17-1"><span class="nb">include</span><span class="p">(</span><span class="s">CMakeDependentOption</span><span class="p">)</span>
</span><span id="__span-17-2">
</span><span id="__span-17-3"><span class="nb">option</span><span class="p">(</span><span class="s">HT_ENABLE_GPU</span><span class="w"> </span><span class="s2">&quot;Whether to enable GPU based codes vs CPU based&quot;</span><span class="w"> </span><span class="s">OFF</span><span class="p">)</span>
</span><span id="__span-17-4"><span class="nb">option</span><span class="p">(</span><span class="s">HT_ENABLE_GRAPH_PROFILER</span><span class="w"> </span><span class="s2">&quot;Whether to enable the graph profiler&quot;</span><span class="w"> </span><span class="s">OFF</span><span class="p">)</span>
</span><span id="__span-17-5"><span class="nb">cmake_dependent_option</span><span class="p">(</span><span class="s">HT_ENABLE_WEB_PROFILING</span><span class="w"> </span><span class="s2">&quot;Whether to enable web profiling&quot;</span><span class="w"> </span><span class="s">ON</span><span class="w"> </span><span class="s">HT_ENABLE_GRAPH_PROFILER</span><span class="w"> </span><span class="s">OFF</span><span class="p">)</span>
</span><span id="__span-17-6">
</span><span id="__span-17-7"><span class="nb">if</span><span class="p">(</span><span class="s">HT_ENABLE_GPU</span><span class="p">)</span>
</span><span id="__span-17-8"><span class="w">    </span><span class="nb">add_definitions</span><span class="p">(</span><span class="s">-DMEDIAPIPE_DISABLE_GPU=0</span><span class="p">)</span>
</span><span id="__span-17-9"><span class="nb">else</span><span class="p">()</span>
</span><span id="__span-17-10"><span class="w">    </span><span class="nb">add_definitions</span><span class="p">(</span><span class="s">-DMEDIAPIPE_DISABLE_GPU=1</span><span class="p">)</span>
</span><span id="__span-17-11"><span class="nb">endif</span><span class="p">()</span>
</span><span id="__span-17-12"><span class="nb">add_compile_options</span><span class="p">(</span><span class="s">-Wno-deprecated-declarations</span><span class="p">)</span>
</span><span id="__span-17-13"><span class="nb">if</span><span class="p">(</span><span class="s">HT_ENABLE_GRAPH_PROFILER</span><span class="p">)</span>
</span><span id="__span-17-14"><span class="w">    </span><span class="nb">add_definitions</span><span class="p">(</span><span class="s">-DMEDIAPIPE_PROFILER_AVAILABLE=1</span><span class="p">)</span>
</span><span id="__span-17-15"><span class="w">    </span><span class="nb">if</span><span class="p">(</span><span class="s">HT_ENABLE_WEB_PROFILING</span><span class="p">)</span>
</span><span id="__span-17-16"><span class="w">        </span><span class="nb">add_definitions</span><span class="p">(</span><span class="s">-DMEDIAPIPE_WEB_PROFILING_ENABLED=1</span><span class="p">)</span>
</span><span id="__span-17-17"><span class="w">    </span><span class="nb">endif</span><span class="p">()</span>
</span><span id="__span-17-18"><span class="nb">endif</span><span class="p">()</span>
</span></code></pre></div>
<p>Here any command line options/flags are declared, and if needed, compile definitions are set.</p>
<h3 id="cmake_module_path">CMAKE_MODULE_PATH</h3>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-18-1"><span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_MODULE_PATH</span>
</span><span id="__span-18-2"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_SOURCE_DIR</span><span class="o">}</span><span class="s">/cmake</span>
</span><span id="__span-18-3"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_MODULE_PATH</span><span class="o">}</span>
</span><span id="__span-18-4"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_INSTALL_PREFIX</span><span class="o">}</span><span class="s">/lib/cmake</span>
</span><span id="__span-18-5"><span class="p">)</span>
</span></code></pre></div>
<p>This section tells CMake where to look first for cmake files for external packages.</p>
<h3 id="dependencies">Dependencies</h3>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-19-1"><span class="nb">find_package</span><span class="p">(</span><span class="s">PkgConfig</span><span class="p">)</span>
</span><span id="__span-19-2">
</span><span id="__span-19-3"><span class="nb">if</span><span class="p">(</span><span class="s">ILLIXR_ROOT</span><span class="p">)</span>
</span><span id="__span-19-4"><span class="w">    </span><span class="nb">set</span><span class="p">(</span><span class="s">ILLIXR_HDR_PATH</span><span class="w"> </span><span class="o">${</span><span class="nv">ILLIXR_ROOT</span><span class="o">}</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">PATH</span><span class="w"> </span><span class="s2">&quot;Location of ILLIXR headers&quot;</span><span class="p">)</span>
</span><span id="__span-19-5"><span class="w">    </span><span class="c">#add_definitions(-DBUILD_ILLIXR)</span>
</span><span id="__span-19-6"><span class="nb">else</span><span class="p">()</span>
</span><span id="__span-19-7"><span class="w">    </span><span class="nb">message</span><span class="p">(</span><span class="s">FATAL_ERROR</span><span class="w"> </span><span class="s2">&quot;ILLIXR_ROOT must be specified&quot;</span><span class="p">)</span>
</span><span id="__span-19-8"><span class="nb">endif</span><span class="p">()</span>
</span><span id="__span-19-9">
</span><span id="__span-19-10"><span class="nb">set</span><span class="p">(</span><span class="s">protobuf_MODULE_COMPATIBLE</span><span class="w"> </span><span class="s">ON</span><span class="p">)</span>
</span><span id="__span-19-11"><span class="nb">find_package</span><span class="p">(</span><span class="s">ZLIB</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
</span><span id="__span-19-12"><span class="nb">find_package</span><span class="p">(</span><span class="s">Protobuf</span><span class="w"> </span><span class="s">3.19</span><span class="w"> </span><span class="s">REQUIRED</span><span class="w"> </span><span class="s">CONFIG</span><span class="p">)</span>
</span><span id="__span-19-13"><span class="nb">pkg_check_modules</span><span class="p">(</span><span class="s">glog</span><span class="w"> </span><span class="s">REQUIRED</span><span class="w"> </span><span class="s">libglog</span><span class="p">)</span>
</span><span id="__span-19-14"><span class="nb">pkg_check_modules</span><span class="p">(</span><span class="s">egl</span><span class="w"> </span><span class="s">REQUIRED</span><span class="w"> </span><span class="s">egl</span><span class="p">)</span>
</span><span id="__span-19-15"><span class="nb">pkg_check_modules</span><span class="p">(</span><span class="s">glesv2</span><span class="w"> </span><span class="s">REQUIRED</span><span class="w"> </span><span class="s">glesv2</span><span class="p">)</span>
</span><span id="__span-19-16"><span class="nb">find_package</span><span class="p">(</span><span class="s">Eigen3</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
</span><span id="__span-19-17"><span class="nb">find_package</span><span class="p">(</span><span class="s">OpenCV</span><span class="w"> </span><span class="s">4</span><span class="w"> </span><span class="s">REQUIRED</span><span class="p">)</span>
</span><span id="__span-19-18"><span class="nb">set</span><span class="p">(</span><span class="s">ENABLE_OPENCV</span><span class="w"> </span><span class="s">ON</span><span class="p">)</span>
</span><span id="__span-19-19">
</span><span id="__span-19-20"><span class="nb">set</span><span class="p">(</span><span class="s">PROTOBUF_DESCRIPTORS</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="s">CACHE</span><span class="w"> </span><span class="s">INTERNAL</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span id="__span-19-21"><span class="nb">pkg_check_modules</span><span class="p">(</span><span class="s">cpuinfo</span><span class="w"> </span><span class="s">REQUIRED</span><span class="w"> </span><span class="s">libcpuinfo</span><span class="p">)</span>
</span><span id="__span-19-22">
</span><span id="__span-19-23"><span class="nb">find_package</span><span class="p">(</span><span class="s">tfl-XNNPACK</span><span class="w"> </span><span class="s">REQUIRED</span><span class="w"> </span><span class="s">CONFIG</span><span class="p">)</span>
</span><span id="__span-19-24"><span class="nb">find_package</span><span class="p">(</span><span class="s">pthreadpool</span><span class="w"> </span><span class="s">REQUIRED</span><span class="w"> </span><span class="s">CONFIG</span><span class="p">)</span>
</span><span id="__span-19-25"><span class="nb">find_package</span><span class="p">(</span><span class="s">tensorflow-lite</span><span class="w"> </span><span class="s">REQUIRED</span><span class="w"> </span><span class="s">CONFIG</span><span class="p">)</span>
</span><span id="__span-19-26">
</span><span id="__span-19-27"><span class="nb">if</span><span class="p">(</span><span class="s">tfl-XNNPACK_BINARY_DIR</span><span class="p">)</span>
</span><span id="__span-19-28"><span class="w">    </span><span class="nb">add_link_options</span><span class="p">(</span><span class="s">-L</span><span class="o">${</span><span class="nv">tfl-XNNPACK_BINARY_DIR</span><span class="o">}</span><span class="p">)</span>
</span><span id="__span-19-29"><span class="nb">endif</span><span class="p">()</span>
</span></code></pre></div>
<p>Here we search for any dependencies.</p>
<h3 id="protobuf-helpers">Protobuf Helpers</h3>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-20-1"><span class="nb">include</span><span class="p">(</span><span class="s">mediapipe/protobuf.cmake</span><span class="p">)</span>
</span><span id="__span-20-2"><span class="nb">include</span><span class="p">(</span><span class="s">cmake/encoder.cmake</span><span class="p">)</span>
</span></code></pre></div>
<p>The protobuf files from Mediapipe need some special processing. These files define functions which properly handle this.</p>
<h3 id="special-operations">Special Operations</h3>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-21-1"><span class="nb">file</span><span class="p">(</span><span class="s">MAKE_DIRECTORY</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="o">}</span><span class="s">/mediapipe/calculators/tensor</span><span class="p">)</span>
</span><span id="__span-21-2"><span class="nb">foreach</span><span class="p">(</span><span class="s">ITEM</span><span class="w"> </span><span class="o">${</span><span class="nv">PROTOBUF_DESCRIPTORS</span><span class="o">}</span><span class="p">)</span>
</span><span id="__span-21-3"><span class="w">    </span><span class="nb">get_filename_component</span><span class="p">(</span><span class="s">_FILE</span><span class="w"> </span><span class="o">${</span><span class="nv">ITEM</span><span class="o">}</span><span class="w"> </span><span class="s">NAME_WE</span><span class="p">)</span>
</span><span id="__span-21-4"><span class="w">    </span><span class="nb">add_custom_target</span><span class="p">(</span><span class="o">${</span><span class="nv">_FILE</span><span class="o">}</span><span class="s">_desc</span>
</span><span id="__span-21-5"><span class="w">                      </span><span class="s">ALL</span>
</span><span id="__span-21-6"><span class="w">                      </span><span class="s">COMMAND</span><span class="w"> </span><span class="s">cat</span><span class="w"> </span><span class="o">${</span><span class="nv">ITEM</span><span class="o">}</span><span class="w"> </span><span class="s">&gt;&gt;</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="o">}</span><span class="s">/inference_calculator_proto_transitive-transitive-descriptor-set.proto.bin_temp</span>
</span><span id="__span-21-7"><span class="w">                      </span><span class="s">DEPENDS</span><span class="w"> </span><span class="s">encode_as_c_string</span><span class="w"> </span><span class="o">${</span><span class="nv">ITEM</span><span class="o">}</span>
</span><span id="__span-21-8"><span class="w">    </span><span class="p">)</span>
</span><span id="__span-21-9"><span class="w">    </span><span class="nb">list</span><span class="p">(</span><span class="s">APPEND</span><span class="w"> </span><span class="s">FILE_DEPS</span><span class="w"> </span><span class="o">${</span><span class="nv">_FILE</span><span class="o">}</span><span class="s">_desc</span><span class="p">)</span>
</span><span id="__span-21-10"><span class="nb">endforeach</span><span class="p">()</span>
</span><span id="__span-21-11"><span class="nb">add_custom_target</span><span class="p">(</span><span class="s">move_temp_bin</span><span class="w"> </span><span class="s">ALL</span>
</span><span id="__span-21-12"><span class="w">                  </span><span class="s">COMMAND</span><span class="w"> </span><span class="s">mv</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="o">}</span><span class="s">/inference_calculator_proto_transitive-transitive-descriptor-set.proto.bin_temp</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="o">}</span><span class="s">/inference_calculator_proto_transitive-transitive-descriptor-set.proto.bin</span>
</span><span id="__span-21-13"><span class="w">                  </span><span class="s">DEPENDS</span><span class="w"> </span><span class="o">${</span><span class="nv">FILE_DEPS</span><span class="o">}</span>
</span><span id="__span-21-14"><span class="w">                  </span><span class="s">BYPRODUCTS</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="o">}</span><span class="s">/inference_calculator_proto_transitive-transitive-descriptor-set.proto.bin</span>
</span><span id="__span-21-15"><span class="p">)</span>
</span><span id="__span-21-16">
</span><span id="__span-21-17"><span class="nb">add_custom_target</span><span class="p">(</span><span class="s">encode_descriptor_sets</span><span class="w"> </span><span class="s">ALL</span>
</span><span id="__span-21-18"><span class="w">                  </span><span class="s">COMMAND</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_COMMAND</span><span class="o">}</span><span class="w"> </span><span class="s">-E</span><span class="w"> </span><span class="s">env</span><span class="w"> </span><span class="s2">&quot;LD_LIBRARY_PATH=${CMAKE_INSTALL_PREFIX}/lib&quot;</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="o">}</span><span class="s">/encode_as_c_string</span>
</span><span id="__span-21-19"><span class="w">                  </span><span class="o">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="o">}</span><span class="s">/inference_calculator_proto_transitive-transitive-descriptor-set.proto.bin</span><span class="w"> </span><span class="s">&gt;</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="o">}</span><span class="s">/mediapipe/calculators/tensor/inference_calculator_proto_descriptors.inc</span>
</span><span id="__span-21-20"><span class="w">                  </span><span class="s">DEPENDS</span><span class="w"> </span><span class="s">encode_as_c_string</span><span class="w"> </span><span class="s">move_temp_bin</span>
</span><span id="__span-21-21"><span class="w">                  </span><span class="s">BYPRODUCTS</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="o">}</span><span class="s">/mediapipe/calculators/tensor/inference_calculator_proto_descriptors.inc</span>
</span><span id="__span-21-22"><span class="p">)</span>
</span><span id="__span-21-23">
</span><span id="__span-21-24"><span class="nb">include</span><span class="p">(</span><span class="s">cmake/message_util.cmake</span><span class="p">)</span>
</span><span id="__span-21-25"><span class="nb">add_custom_target</span><span class="p">(</span><span class="s">make_message_type</span>
</span><span id="__span-21-26"><span class="w">                  </span><span class="s">COMMAND</span><span class="w"> </span><span class="s">message_type_util</span>
</span><span id="__span-21-27"><span class="w">                  </span><span class="s">--input_path=</span><span class="o">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="o">}</span><span class="s">/inference_calculator_proto_transitive-transitive-descriptor-set.proto.bin</span><span class="w"> </span><span class="s">--root_type_macro_output_path=</span><span class="o">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="o">}</span><span class="s">/mediapipe/calculators/tensor/inference_calculator_options_lib_type_name.h</span>
</span><span id="__span-21-28"><span class="w">                  </span><span class="s">DEPENDS</span><span class="w"> </span><span class="s">message_type_util</span>
</span><span id="__span-21-29"><span class="w">                  </span><span class="s">BYPRODUCTS</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="o">}</span><span class="s">/mediapipe/calculators/tensor/inference_calculator_options_lib_type_name.h</span>
</span><span id="__span-21-30"><span class="p">)</span>
</span></code></pre></div>
<p>One of the steps required files to be concatenated together. This code replicates that functionality. See the
<a href="#protobufcmake-files">protobuf.cmake</a> section for more details.</p>
<h3 id="the-plugin-itself">The Plugin Itself</h3>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-22-1"><span class="nb">set</span><span class="p">(</span><span class="s">PLUGIN_NAME</span><span class="w"> </span><span class="s">plugin.hand_tracking</span><span class="o">${</span><span class="nv">ILLIXR_BUILD_SUFFIX</span><span class="o">}</span><span class="p">)</span>
</span><span id="__span-22-2"><span class="nb">add_library</span><span class="p">(</span><span class="o">${</span><span class="nv">PLUGIN_NAME</span><span class="o">}</span><span class="w"> </span><span class="s">SHARED</span><span class="w"> </span><span class="s">plugin.cpp</span><span class="p">)</span>
</span><span id="__span-22-3">
</span><span id="__span-22-4"><span class="nb">add_subdirectory</span><span class="p">(</span><span class="s">mediapipe</span><span class="p">)</span>
</span><span id="__span-22-5">
</span><span id="__span-22-6"><span class="nb">target_link_libraries</span><span class="p">(</span><span class="o">${</span><span class="nv">PLUGIN_NAME</span><span class="o">}</span><span class="w"> </span><span class="s">PUBLIC</span>
</span><span id="__span-22-7"><span class="w">                      </span><span class="o">${</span><span class="nv">OpenCV_LIBRARIES</span><span class="o">}</span>
</span><span id="__span-22-8"><span class="w">                      </span><span class="s">absl::base</span>
</span><span id="__span-22-9"><span class="w">                      </span><span class="s">absl::flags_parse</span>
</span><span id="__span-22-10"><span class="w">                      </span><span class="s">fmt</span>
</span><span id="__span-22-11"><span class="p">)</span>
</span><span id="__span-22-12">
</span><span id="__span-22-13"><span class="nb">target_include_directories</span><span class="p">(</span><span class="o">${</span><span class="nv">PLUGIN_NAME</span><span class="o">}</span><span class="w"> </span><span class="s">PRIVATE</span>
</span><span id="__span-22-14"><span class="w">                           </span><span class="o">${</span><span class="nv">ILLIXR_HDR_PATH</span><span class="o">}</span>
</span><span id="__span-22-15"><span class="w">                           </span><span class="o">${</span><span class="nv">OpenCV_INCLUDE_DIRS</span><span class="o">}</span>
</span><span id="__span-22-16"><span class="w">                           </span><span class="o">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="o">}</span>
</span><span id="__span-22-17"><span class="w">                           </span><span class="o">${</span><span class="nv">CMAKE_SOURCE_DIR</span><span class="o">}</span>
</span><span id="__span-22-18"><span class="p">)</span>
</span><span id="__span-22-19"><span class="nb">install</span><span class="p">(</span><span class="s">TARGETS</span><span class="w"> </span><span class="o">${</span><span class="nv">PLUGIN_NAME</span><span class="o">}</span><span class="w"> </span><span class="s">DESTINATION</span><span class="w"> </span><span class="s">lib</span><span class="p">)</span>
</span></code></pre></div>
<p>The plugin itself is declared as a library. All the hand tracking code is inside the mediapipe subdirectory.</p>
<h2 id="adapting-the-tool-for-illixr">Adapting the Tool for ILLIXR</h2>
<p>Now that you have the code in place we will put together the build files needed.</p>
<ol>
<li>In the mediapipe directory create files called <code>CMakeLists.txt</code> and <code>protobuf.cmake</code></li>
<li>In each subdirectory that contains source or header files (or whose subdirectories contain such files) create a
   <code>build.cmake</code> file</li>
<li>In each subdirectory that contains a protobuf file (or whose subdirectories contain such files) create a
   <code>protobuf.cmake</code> file</li>
</ol>
<p>The <code>build.cmake</code> files will list all source files needed to build the tool, while the <code>protobuf.cmake</code> files will be
used to process the protobuf files.</p>
<h3 id="protobufcmake-files">protobuf.cmake Files</h3>
<p>There are three types of <code>protobuf.cmake</code> files. The first are those in directories which contain protobuf files, while
the second are those whose subdirectories contain protobuf files, and the third is a combination of the previous two
types. For the second type, all the lines in the file will be including <code>protobuf.cmake</code> files from subdirectories. For
example</p>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-23-1"><span class="nb">include</span><span class="p">(</span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/core/protobuf.cmake</span><span class="p">)</span>
</span></code></pre></div>
<p>For the first type, they will have an include file at the top, and then a function call for each protobuf file in the
directory.</p>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-24-1"><span class="nb">include</span><span class="p">(</span><span class="o">${</span><span class="nv">CMAKE_SOURCE_DIR</span><span class="o">}</span><span class="s">/cmake/protoc_generate_obj.cmake</span><span class="p">)</span>
</span><span id="__span-24-2">
</span><span id="__span-24-3"><span class="nb">protobuf_generate_obj</span><span class="p">(</span><span class="s">PROTO_PATH</span><span class="w"> </span><span class="s">calculators/util</span><span class="w"> </span><span class="s">OBJ_NAME</span><span class="w"> </span><span class="s">annotation_overlay_calculator</span><span class="p">)</span>
</span></code></pre></div>
<p>The <code>protobuf_generate_obj</code> function generates a CMake TARGET which can be used to link against when compiling the code.
The signature for the function is:</p>
<ul>
<li><strong>PROTO_PATH</strong> - the path to the protobuf file (not including the file name), relative to the mediapipe directory</li>
<li><strong>OBJ_NAME</strong> - the name of the protobuf file (without the extension)</li>
<li><strong>DESCRIPTORS</strong> - A flag that will append descriptor files to the master list in CACHE</li>
</ul>
<p>In the above example the CMake TARGET will be named calculators.util.annotation_overlay_calculator_proto. At the current
time,
there is no easy way to determine which protos need to have the <strong>DESCRIPTORS</strong> flag set. The easiest way may be to
build the mediapipe tool with bazel and then search the build tree for files that end in <code>.proto.bin</code>. This will
indicate which protos need to have the <strong>DESCRIPTORS</strong> flag set. These files will be treated specially in the main
<code>CMakeLists.txt</code> for combining and processing.</p>
<h3 id="buildcmake-files">build.cmake Files</h3>
<p>Like the <code>protobuf.cmake</code> files, the <code>build.cmake</code> files also have three types, one for directories that only contain
source/header files, one that contains only other directories, and one that is a combination of the previous two. For
the second type, each of the lines of the file will be including other <code>build.cmake</code> files from subdirectories. For
example</p>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-25-1"><span class="nb">include</span><span class="p">(</span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/core/build.cmake</span><span class="p">)</span>
</span></code></pre></div>
<p>For the first type the file will add all the source files in the directory to the main target.</p>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-26-1"><span class="nb">set</span><span class="p">(</span><span class="s">UTIL_SOURCES</span>
</span><span id="__span-26-2"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/annotation_overlay_calculator.cc</span>
</span><span id="__span-26-3"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/association_norm_rect_calculator.cc</span>
</span><span id="__span-26-4"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/collection_has_min_size_calculator.cc</span>
</span><span id="__span-26-5"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/detection_letterbox_removal_calculator.cc</span>
</span><span id="__span-26-6"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/detections_to_rects_calculator.cc</span>
</span><span id="__span-26-7"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/detections_to_render_data_calculator.cc</span>
</span><span id="__span-26-8"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/filter_collection_calculator.cc</span>
</span><span id="__span-26-9"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/illixr_output_calculator.cc</span>
</span><span id="__span-26-10"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/labels_to_render_data_calculator.cc</span>
</span><span id="__span-26-11"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/landmark_letterbox_removal_calculator.cc</span>
</span><span id="__span-26-12"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/landmark_projection_calculator.cc</span>
</span><span id="__span-26-13"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/landmarks_to_render_data_calculator.cc</span>
</span><span id="__span-26-14"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/local_file_contents_calculator.cc</span>
</span><span id="__span-26-15"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/non_max_suppression_calculator.cc</span>
</span><span id="__span-26-16"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/rect_to_render_data_calculator.cc</span>
</span><span id="__span-26-17"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/rect_transformation_calculator.cc</span>
</span><span id="__span-26-18"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/thresholding_calculator.cc</span>
</span><span id="__span-26-19"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/world_landmark_projection_calculator.cc</span>
</span><span id="__span-26-20"><span class="p">)</span>
</span><span id="__span-26-21">
</span><span id="__span-26-22"><span class="nb">set</span><span class="p">(</span><span class="s">UTIL_HEADERS</span>
</span><span id="__span-26-23"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/association_calculator.h</span>
</span><span id="__span-26-24"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/collection_has_min_size_calculator.h</span>
</span><span id="__span-26-25"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/detections_to_rects_calculator.h</span>
</span><span id="__span-26-26"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/filter_collection_calculator.h</span>
</span><span id="__span-26-27"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/landmarks_to_render_data_calculator.h</span>
</span><span id="__span-26-28"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/illixr_output_calculator.h</span>
</span><span id="__span-26-29"><span class="w">    </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/illixr_data.h</span>
</span><span id="__span-26-30"><span class="p">)</span>
</span><span id="__span-26-31">
</span><span id="__span-26-32"><span class="nb">target_sources</span><span class="p">(</span><span class="o">${</span><span class="nv">PLUGIN_NAME</span><span class="o">}</span><span class="w"> </span><span class="s">PRIVATE</span>
</span><span id="__span-26-33"><span class="w">               </span><span class="o">${</span><span class="nv">UTIL_SOURCES</span><span class="o">}</span>
</span><span id="__span-26-34"><span class="w">               </span><span class="o">${</span><span class="nv">UTIL_HEADERS</span><span class="o">}</span>
</span><span id="__span-26-35"><span class="p">)</span>
</span></code></pre></div>
<h3 id="handling-pbtxt-files">Handling pbtxt Files</h3>
<p>In the <code>graph</code> and <code>modules</code> directories the <code>build.cmake</code> files will call functions to compile the subgraph files into
a binary format. The main input pbtxt file will need to be installed as a text file, it will be labeled
<code>mediapipe_binary_graph</code> in the <code>BUILD</code> file. Some pbtxt files carry information about where tflite files are installed.
These will need to be modified to contain the proper installed location, via <code>configure_file</code> calls in cmake.</p>
<p><code>Pbtxt</code> files which have been labeled <code>mediapipe_simple_subgraph</code> in their respective <code>BUILD</code> files will need to be
specially compiled. There is a function <code>make_proto_binary</code> in <code>cmake/make_pb_binary.cmake</code>. For each of these pbtxt
files you should have a list of dependencies. The only ones we need now are the protobuf ones, as they need to be
handled like libraries. Here is a sample code snippet from a <code>build.cmake</code> file.</p>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-27-1"><span class="nb">include</span><span class="p">(</span><span class="o">${</span><span class="nv">CMAKE_SOURCE_DIR</span><span class="o">}</span><span class="s">/cmake/make_pb_binary.cmake</span><span class="p">)</span>
</span><span id="__span-27-2">
</span><span id="__span-27-3"><span class="c"># make a list of all protobuf dependencies for this pbtxt file </span>
</span><span id="__span-27-4"><span class="nb">set</span><span class="p">(</span><span class="s">HLLR_LIBRARIES</span>
</span><span id="__span-27-5"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:calculators.internal.callback_packet_calculator_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-6"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:calculators.util.rect_transformation_calculator_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-7"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:framework.calculator_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-8"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:framework.calculator_options_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-9"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:framework.calculator_profile_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-10"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:framework.mediapipe_options_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-11"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:framework.packet_factory_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-12"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:framework.packet_generator_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-13"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:framework.status_handler_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-14"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:framework.stream_handler_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-15"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:framework.thread_pool_executor_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-16"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:framework.deps.proto_descriptor_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-17"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:framework.formats.landmark_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-18"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:framework.formats.rect_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-19"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:framework.stream_handler.default_input_stream_handler_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-20"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:framework.tool.calculator_graph_template_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-21"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:framework.tool.field_data_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-22"><span class="w">    </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:framework.tool.packet_generator_wrapper_calculator_proto</span><span class="o">&gt;</span>
</span><span id="__span-27-23"><span class="p">)</span>
</span><span id="__span-27-24">
</span><span id="__span-27-25"><span class="c"># compile the pbtxt file</span>
</span><span id="__span-27-26"><span class="nb">make_proto_binary</span><span class="p">(</span><span class="s">BINARY_NAME</span><span class="w"> </span><span class="s">hand_landmark_landmarks_to_roi_graph_text_to_binary_graph</span>
</span><span id="__span-27-27"><span class="w">                  </span><span class="s">FILE_ROOT</span><span class="w"> </span><span class="s">modules/hand_landmark</span>
</span><span id="__span-27-28"><span class="w">                  </span><span class="s">FILE_BASE_NAME</span><span class="w"> </span><span class="s">hand_landmark_landmarks_to_roi</span>
</span><span id="__span-27-29"><span class="w">                  </span><span class="s">CLASS_NAME</span><span class="w"> </span><span class="s">HandLandmarkLandmarksToRoi</span>
</span><span id="__span-27-30"><span class="w">                  </span><span class="s">PROTO_LIBRARIES</span><span class="w"> </span><span class="o">${</span><span class="nv">HLLR_LIBRARIES</span><span class="o">}</span>
</span><span id="__span-27-31"><span class="p">)</span>
</span></code></pre></div>
<p>The inputs to <code>make_proto_binary</code> are</p>
<ul>
<li><strong>BINARY_NAME</strong>: name of the binary to create</li>
<li><strong>FILE_ROOT</strong>: the path to the pbtxt file (relative to root directory)</li>
<li><strong>FILE_BASE_NAME</strong>: the name of the pbtxt file (no path, no suffix)</li>
<li><strong>CLASS_NAME</strong>: the name to register this as, this will be what is specified by the <code>register_as</code> key in the <code>BUILD</code>
  file</li>
<li><strong>PROTO_LIBRARIES</strong>: the protobuf libraries to link against</li>
</ul>
<h2 id="writing-your-plugin">Writing Your Plugin</h2>
<p>In this guide we will refer to the entire mediapipe code as the tool. The workflow of the tool is defined by <a href="https://ai.google.dev/edge/mediapipe/framework/framework_concepts/graphs.md">graph</a>
files. The individual <a href="https://ai.google.dev/edge/mediapipe/framework/framework_concepts/calculators.md">calculators</a> communicate with each other via <a href="https://ai.google.dev/edge/mediapipe/framework/framework_concepts/packets.md">packets</a>.</p>
<h3 id="understanding-graph-files">Understanding Graph Files</h3>
<p>The graph files (those with a pbtxt suffix) are the real drivers of the tool's workflow. They define what calculators
are run in what order, and what their inputs and outputs are. In mediapipe, calculators are roughly equivalent to ILLIXR
plugins. There are several levels of these graph files. The topmost one will be read as a text file by the tool's
initializing code, and lives in mediapipe/graph/<tool> and are usually small compared to others. They also will link to
other graph files (also called calculators in this context). All the other pbtxt files will be compiled into the tool
library.</p>
<p>Let's look at the hand tracking main graph file (hand_tracking_desktop_live.pbtxt) in snippets.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-28-1"># CPU image. (ImageFrame)
</span><span id="__span-28-2">input_stream: &quot;input_video&quot;
</span><span id="__span-28-3">input_stream: &quot;image_data&quot;
</span><span id="__span-28-4"># CPU image. (ImageFrame)
</span><span id="__span-28-5">output_stream: &quot;illixr_data&quot;
</span></code></pre></div>
<p>The <code>input_stream</code> keyword defines what data will be sent to the tool as input. The <code>output_stream</code> keyword defines what
data will be sent out of the tool. As far as I know, there is no limit on the number of each. The value of both of these
keywords is a string value which names the stream, these streams will be referred to by these names in the C++ code. At
this level, there is no typing of the data, just labelling the streams.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-29-1">node {
</span><span id="__span-29-2">  calculator: &quot;HandLandmarkTrackingCpu&quot;
</span><span id="__span-29-3">  input_stream: &quot;IMAGE:input_video&quot;
</span><span id="__span-29-4">  input_side_packet: &quot;NUM_HANDS:num_hands&quot;
</span><span id="__span-29-5">  output_stream: &quot;LANDMARKS:landmarks&quot;
</span><span id="__span-29-6">  output_stream: &quot;HANDEDNESS:handedness&quot;
</span><span id="__span-29-7">  output_stream: &quot;PALM_DETECTIONS:multi_palm_detections&quot;
</span><span id="__span-29-8">  output_stream: &quot;HAND_ROIS_FROM_LANDMARKS:multi_hand_rects&quot;
</span><span id="__span-29-9">  output_stream: &quot;HAND_ROIS_FROM_PALM_DETECTIONS:multi_palm_rects&quot;
</span><span id="__span-29-10">}
</span></code></pre></div>
<p>The <code>node</code> defines a single calculator/subgraph. The name of the calculator/subgraph is defined in the <code>calculator</code>
entry. This will match a class which has already bee compiled in the code (case-sensitive).</p>
<p>As above, the <code>input_stream</code> and <code>output_stream</code> define the inputs and outputs to/from the calculator.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The names of the streams are different from above. They have a format of <code>NAME:stream_name</code>. </p>
</div>
<p>The first, all caps, name acts
as a reference to the second name. When the streams are referenced in the C++ code, the name used will be the first (or
as above, only name). Thus using the two name scheme allows you to change the actual stream (second name) in the graph
files, without having to change the C++ code, which uses the first name reference.</p>
<p>For a more complete guide on the graph file format see this <a href="https://ai.google.dev/edge/mediapipe/framework/framework_concepts/graphs.md">guide</a>. You can also visualize and error check graphs
with this useful online <a href="https://viz.mediapipe.dev/">tool</a></p>
<h3 id="sending-data-to-the-tool">Sending Data To the Tool</h3>
<p>Sending data to the tool is straight forward. Take the following code snippet as an example</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-30-1"><span class="k">auto</span><span class="w"> </span><span class="n">img_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">absl</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mediapipe</span><span class="o">::</span><span class="n">ImageData</span><span class="o">&gt;</span><span class="p">(</span><span class="n">image_data</span><span class="p">);</span>
</span><span id="__span-30-2"><span class="k">auto</span><span class="w"> </span><span class="n">img_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_graph</span><span class="p">.</span><span class="n">AddPacketToInputStream</span><span class="p">(</span><span class="n">kImageDataTag</span><span class="p">,</span>
</span><span id="__span-30-3"><span class="w">                                                </span><span class="n">mediapipe</span><span class="o">::</span><span class="n">Adopt</span><span class="p">(</span><span class="n">img_ptr</span><span class="p">.</span><span class="n">release</span><span class="p">()).</span><span class="n">At</span><span class="p">(</span>
</span><span id="__span-30-4"><span class="w">                                                       </span><span class="n">mediapipe</span><span class="o">::</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">frame_timestamp_us</span><span class="p">)));</span>
</span><span id="__span-30-5">
</span><span id="__span-30-6"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">img_status</span><span class="p">.</span><span class="n">ok</span><span class="p">())</span>
</span><span id="__span-30-7"><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="n">img_status</span><span class="p">.</span><span class="n">message</span><span class="p">()));</span>
</span></code></pre></div>
<p>The first line creates a unique pointer which wraps the data we want to send to the tool. The second line stages the
packet to the graph with a call to <code>AddPacketToInputStream</code>. The first argument is the name of the stream to add the
packet to (will be one of the names from the graph file), the second argument is the data being sent (it is fully
adopted by the stream) along with the current timestamp.
The last two lines check that there was no error in adding the packet, and throw an exception if there was.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The timestamp values do not have to match any specific timing convention, but must increase with each call to add a packet to a specific stream. </p>
</div>
<h3 id="getting-data-from-the-tool">Getting Data From the Tool</h3>
<p>Getting the data from the tool is also straight forward. Take the following code snippet as an example</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-31-1"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_poller</span><span class="o">-&gt;</span><span class="n">Next</span><span class="p">(</span><span class="o">&amp;</span><span class="n">_packet</span><span class="p">))</span>
</span><span id="__span-31-2"><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">output_frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_packet</span><span class="p">.</span><span class="n">Get</span><span class="o">&lt;</span><span class="n">mediapipe</span><span class="o">::</span><span class="n">ILLIXR</span><span class="o">::</span><span class="n">illixr_ht_frame</span><span class="o">&gt;</span><span class="p">();</span>
</span><span id="__span-31-3"><span class="w">    </span><span class="p">...</span>
</span><span id="__span-31-4"><span class="k">else</span>
</span><span id="__span-31-5"><span class="w">    </span><span class="p">...</span>
</span></code></pre></div>
<p>The if statement checks to see if there is a packet available. The <code>Next</code> function returns a boolean (true if a packet
is available), and puts the packet, if any, in the <code>_packet</code> variable. The following line extracts and casts the packet
to the appropriate type. The following lines can use the data <code>output_frame</code> in this example, as needed.</p>
<h3 id="adding-a-calculator">Adding a Calculator</h3>
<p>In some instances you may want to manipulate the output stream from a tool to better suit your needs. The original
version of the hand tracking tool only returned an image with the hand tracking results visually represented. For
ILLIXR, we wanted to have the actual hand tracking data available (points on each hand, what hand(s) were detected,
etc.). So a calculator was added to the end of the tool which gathered the relevant data together into a single
structure. On of the other calculators was also modified so that the output image was transparent, so that the visual
representation could be used as an overlay. Here we will look at how to create a new calculator from scratch.</p>
<h4 id="changing-graph-files">Changing Graph Files</h4>
<p>The first thing to do is to add a new <code>node</code> to the appropriate graph file. The name you give your calculator is
case-sensitive and must match the calculator class name in your code. Be sure to add whatever input and output streams
you will need.</p>
<h4 id="data-structures">Data Structures</h4>
<p>Since whatever data the tool originally produced did not meet your needs, you will need to create a new data type which
encapsulates all that you want. This data structure will be the packet you get from the graph at the end, and does not
need to be the same data that your plugin publishes to ILLIXR. The file for this should be put in
<code>mediapipe/calculators/util</code>. The following file is for the hand tracking tool, in <code>illixr_data.h</code>.</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-32-1"><span class="cp">#pragma once</span>
</span><span id="__span-32-2"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>
</span><span id="__span-32-3">
</span><span id="__span-32-4"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;mediapipe/framework/port/opencv_core_inc.h&quot;</span>
</span><span id="__span-32-5"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;illixr/hand_tracking_data.hpp&quot;</span>
</span><span id="__span-32-6">
</span><span id="__span-32-7"><span class="k">namespace</span><span class="w"> </span><span class="nn">mediapipe</span><span class="o">::</span><span class="nn">ILLIXR</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-8"><span class="k">struct</span><span class="w"> </span><span class="nc">illixr_ht_frame</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-9"><span class="w">    </span><span class="n">cv</span><span class="o">::</span><span class="n">Mat</span><span class="o">*</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
</span><span id="__span-32-10">
</span><span id="__span-32-11"><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">image_id</span><span class="p">;</span>
</span><span id="__span-32-12"><span class="w">    </span><span class="o">::</span><span class="n">ILLIXR</span><span class="o">::</span><span class="n">image</span><span class="o">::</span><span class="n">image_type</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
</span><span id="__span-32-13"><span class="w">    </span><span class="o">::</span><span class="n">ILLIXR</span><span class="o">::</span><span class="n">rect</span><span class="o">*</span><span class="w"> </span><span class="n">left_palm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
</span><span id="__span-32-14"><span class="w">    </span><span class="o">::</span><span class="n">ILLIXR</span><span class="o">::</span><span class="n">rect</span><span class="o">*</span><span class="w"> </span><span class="n">right_palm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
</span><span id="__span-32-15"><span class="w">    </span><span class="o">::</span><span class="n">ILLIXR</span><span class="o">::</span><span class="n">rect</span><span class="o">*</span><span class="w"> </span><span class="n">left_hand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
</span><span id="__span-32-16"><span class="w">    </span><span class="o">::</span><span class="n">ILLIXR</span><span class="o">::</span><span class="n">rect</span><span class="o">*</span><span class="w"> </span><span class="n">right_hand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
</span><span id="__span-32-17">
</span><span id="__span-32-18"><span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">left_confidence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span>
</span><span id="__span-32-19"><span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">right_confidence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="p">;</span>
</span><span id="__span-32-20"><span class="w">    </span><span class="o">::</span><span class="n">ILLIXR</span><span class="o">::</span><span class="n">hand_points</span><span class="o">*</span><span class="w"> </span><span class="n">left_hand_points</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
</span><span id="__span-32-21"><span class="w">    </span><span class="o">::</span><span class="n">ILLIXR</span><span class="o">::</span><span class="n">hand_points</span><span class="o">*</span><span class="w"> </span><span class="n">right_hand_points</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
</span><span id="__span-32-22">
</span><span id="__span-32-23"><span class="w">    </span><span class="o">~</span><span class="n">illixr_ht_frame</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-24"><span class="w">        </span><span class="k">delete</span><span class="w"> </span><span class="n">image</span><span class="p">;</span>
</span><span id="__span-32-25"><span class="w">        </span><span class="k">delete</span><span class="w"> </span><span class="n">left_palm</span><span class="p">;</span>
</span><span id="__span-32-26"><span class="w">        </span><span class="k">delete</span><span class="w"> </span><span class="n">right_palm</span><span class="p">;</span>
</span><span id="__span-32-27"><span class="w">        </span><span class="k">delete</span><span class="w"> </span><span class="n">left_hand</span><span class="p">;</span>
</span><span id="__span-32-28"><span class="w">        </span><span class="k">delete</span><span class="w"> </span><span class="n">right_hand</span><span class="p">;</span>
</span><span id="__span-32-29"><span class="w">        </span><span class="k">delete</span><span class="w"> </span><span class="n">left_hand_points</span><span class="p">;</span>
</span><span id="__span-32-30"><span class="w">        </span><span class="k">delete</span><span class="w"> </span><span class="n">right_hand_points</span><span class="p">;</span>
</span><span id="__span-32-31"><span class="w">    </span><span class="p">}</span>
</span><span id="__span-32-32"><span class="p">};</span>
</span><span id="__span-32-33"><span class="p">}</span>
</span></code></pre></div>
<p>It is just a <code>struct</code> that holds the needed data.</p>
<p>If this struct will be different from what your plugin will publish to ILLIXR, you should also add a header to
<code>include/illixr</code> in your ILLIXR code base which defines that data structure. One main reason for having two different
data structures is if the one for the tool has members whose data type is only defined in the mediapipe code. We don't
want any other part of ILLIXR to need to depend on these external data types, so defining one inside ILLIXR (even if it
is nearly identical), will alleviate this issue.</p>
<p>You will also need to add a protobuf file for defining the options used by your calculator. This guide won't go into the
details of this, as it is likely that you will just need a basic one.</p>
<div class="language-protobuf highlight"><pre><span></span><code><span id="__span-33-1"><span class="k">syntax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;proto2&quot;</span><span class="p">;</span>
</span><span id="__span-33-2">
</span><span id="__span-33-3"><span class="kn">package</span><span class="w"> </span><span class="nn">mediapipe</span><span class="p">;</span>
</span><span id="__span-33-4">
</span><span id="__span-33-5"><span class="k">import</span><span class="w"> </span><span class="s">&quot;mediapipe/framework/calculator.proto&quot;</span><span class="p">;</span>
</span><span id="__span-33-6">
</span><span id="__span-33-7"><span class="kd">message</span><span class="w"> </span><span class="nc">MyCalculatorOptions</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-8"><span class="w">   </span><span class="kd">extend</span><span class="w"> </span><span class="nc">CalculatorOptions</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-9"><span class="w">      </span><span class="k">optional</span><span class="w"> </span><span class="n">MyCalculatorOptions</span><span class="w"> </span><span class="na">ext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">123456789</span><span class="p">;</span>
</span><span id="__span-33-10"><span class="w">   </span><span class="p">}</span>
</span><span id="__span-33-11"><span class="p">}</span>
</span></code></pre></div>
<p>The number after ext must be unique withing the tool. Just grep for <code>ext</code> in the proto files and look for the largest
one and add something like 10 to get your number. This file will also go in <code>mediapipe/calculators/util</code>.</p>
<h4 id="calculator-code">Calculator Code</h4>
<p>Mediapipe calculators are class based objects that inherit from <code>CalculatorBase</code>. You should name your calculator
something useful and put the header and code files in <code>mediapipe/calculators/util</code>. The code below is a minimum outline
of what you will need.</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-34-1"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;mediapipe/framework/calculator_base.h&quot;</span>
</span><span id="__span-34-2">
</span><span id="__span-34-3"><span class="k">class</span><span class="w"> </span><span class="nc">MyCalulator</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">CalculatorBase</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-4"><span class="k">public</span><span class="o">:</span>
</span><span id="__span-34-5"><span class="w">    </span><span class="n">MyCalculator</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">default</span><span class="p">;</span>
</span><span id="__span-34-6"><span class="w">    </span><span class="o">~</span><span class="n">MyCalculator</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
</span><span id="__span-34-7">
</span><span id="__span-34-8"><span class="w">    </span><span class="n">MyCalculator</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MyCalculator</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>
</span><span id="__span-34-9"><span class="w">    </span><span class="n">MyCalculator</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">MyCalculator</span><span class="o">&amp;</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">delete</span><span class="p">;</span>
</span><span id="__span-34-10">
</span><span id="__span-34-11"><span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="n">absl</span><span class="o">::</span><span class="n">Status</span><span class="w"> </span><span class="nf">GetContract</span><span class="p">(</span><span class="n">CalculatorContract</span><span class="o">*</span><span class="w"> </span><span class="n">cc</span><span class="p">);</span>
</span><span id="__span-34-12"><span class="w">    </span><span class="n">absl</span><span class="o">::</span><span class="n">Status</span><span class="w"> </span><span class="nf">Open</span><span class="p">(</span><span class="n">CalculatorContext</span><span class="o">*</span><span class="w"> </span><span class="n">cc</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
</span><span id="__span-34-13"><span class="w">    </span><span class="n">absl</span><span class="o">::</span><span class="n">Status</span><span class="w"> </span><span class="nf">Process</span><span class="p">(</span><span class="n">CalculatorContext</span><span class="o">*</span><span class="w"> </span><span class="n">cc</span><span class="p">)</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
</span><span id="__span-34-14"><span class="k">protected</span><span class="o">:</span>
</span><span id="__span-34-15"><span class="w">    </span><span class="o">::</span><span class="n">mediapipe</span><span class="o">::</span><span class="n">MyCalculatorOptions</span><span class="w"> </span><span class="n">options_</span><span class="p">;</span>
</span><span id="__span-34-16"><span class="p">};</span>
</span></code></pre></div>
<p>You can add any additional functions and data members you need. The sections below will cover the three required
functions.</p>
<h5 id="common-function-calls">Common Function Calls</h5>
<p>There are several functions that are used multiple times throughout a calculator. These deal with checking inputs and
outputs, getting input streams, publishing to output streams, and setting data types for these streams. In each of the
snippets below <code>cc</code> refers to either a <code>CalculatorContract</code> or <code>CalculatorContext</code>, which for these functions we can
treat as identical.</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-35-1"><span class="k">constexpr</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">kInputTag</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;INPUT_TAG&quot;</span><span class="p">;</span>
</span><span id="__span-35-2">
</span><span id="__span-35-3"><span class="n">cc</span><span class="o">-&gt;</span><span class="n">Inputs</span><span class="p">().</span><span class="n">HasTag</span><span class="p">(</span><span class="n">kInputTag</span><span class="p">);</span>
</span><span id="__span-35-4">
</span><span id="__span-35-5">
</span><span id="__span-35-6"><span class="n">cc</span><span class="o">-&gt;</span><span class="n">Outputs</span><span class="p">().</span><span class="n">HasTag</span><span class="p">(</span><span class="n">kInputTag</span><span class="p">);</span>
</span></code></pre></div>
<p>This code checks that the input stream named "INPUT_TAG" (in the graph), is being supplied by the graph. This allows for
a calculator to be fed different input streams. The function <code>HasTag</code> returns a boolean, and is often used in <code>if</code>
statements. There is also a similar call for checking output streams.</p>
<hr />
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-36-1"><span class="n">cc</span><span class="o">-&gt;</span><span class="n">Inputs</span><span class="p">().</span><span class="n">Tag</span><span class="p">(</span><span class="n">kInputTag</span><span class="p">).</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Points</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
</span><span id="__span-36-2">
</span><span id="__span-36-3">
</span><span id="__span-36-4"><span class="n">cc</span><span class="o">-&gt;</span><span class="n">Ouputs</span><span class="p">().</span><span class="n">Tag</span><span class="p">(</span><span class="n">kInputTag</span><span class="p">).</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Points</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
</span></code></pre></div>
<p>This code sets the expected data type for the given tag. This call should be after a <code>HasTag</code> call to ensure that the
input stream is available first.</p>
<hr />
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-37-1"><span class="n">img_data_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">Inputs</span><span class="p">().</span><span class="n">Tag</span><span class="p">(</span><span class="n">kInputTag</span><span class="p">).</span><span class="n">Get</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">Points</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&gt;</span><span class="p">();</span>
</span></code></pre></div>
<p>This code will retrieve the current data from the specified stream. This code also specifies the data type, and should
only be made after a call to <code>Set</code>.</p>
<hr />
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-38-1"><span class="n">cc</span><span class="o">-&gt;</span><span class="n">Outputs</span><span class="p">().</span><span class="n">Tag</span><span class="p">(</span><span class="n">kInputTag</span><span class="p">).</span><span class="n">Add</span><span class="p">(</span><span class="n">frame_data</span><span class="p">.</span><span class="n">release</span><span class="p">(),</span><span class="w"> </span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">InputTimestamp</span><span class="p">());</span>
</span></code></pre></div>
<p>This code adds the given data to the specified stream, along with the timestamp. This should only be called after a call
to <code>Set</code>.</p>
<hr />
<p>Many mediapipe functions return an object of type <code>absl::Status</code>. This type of object encapsulates the status of the
function call, along with any error information.</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-39-1"><span class="n">absl</span><span class="o">::</span><span class="n">Status</span><span class="w"> </span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">myfunc</span><span class="p">();</span>
</span><span id="__span-39-2">
</span><span id="__span-39-3"><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">stat</span><span class="p">.</span><span class="n">ok</span><span class="p">())</span><span class="w">   </span><span class="c1">// returns a boolean: true = success</span>
</span><span id="__span-39-4"><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="n">stat</span><span class="p">.</span><span class="n">message</span><span class="p">()));</span><span class="w">  </span><span class="c1">// throws an exception with the contents of any error messages</span>
</span></code></pre></div>
<h5 id="getcontract">GetContract</h5>
<blockquote>
<p>Calculator authors can specify the expected types of inputs and outputs of a calculator in GetContract(). When a graph
is initialized, the framework calls a static method to verify if the packet types of the connected inputs and outputs
match the information in this specification. <a href="https://ai.google.dev/edge/mediapipe/framework/framework_concepts/calculators">source</a></p>
</blockquote>
<p>Function calls like the following are common here.</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-40-1"><span class="c1">// See which input stream is being supplied by the graph</span>
</span><span id="__span-40-2"><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">Inputs</span><span class="p">().</span><span class="n">HasTag</span><span class="p">(</span><span class="n">kImageFrameTag</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-3"><span class="w">    </span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">Inputs</span><span class="p">().</span><span class="n">Tag</span><span class="p">(</span><span class="n">kImageFrameTag</span><span class="p">).</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">ImageFrame</span><span class="o">&gt;</span><span class="p">();</span>
</span><span id="__span-40-4"><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">Inputs</span><span class="p">().</span><span class="n">HasTag</span><span class="p">(</span><span class="n">kImageTag</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-40-5"><span class="w">    </span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">Inputs</span><span class="p">().</span><span class="n">Tag</span><span class="p">(</span><span class="n">kImageTag</span><span class="p">).</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">mediapipe</span><span class="o">::</span><span class="n">Image</span><span class="o">&gt;</span><span class="p">();</span>
</span><span id="__span-40-6"><span class="p">}</span>
</span><span id="__span-40-7">
</span><span id="__span-40-8">
</span><span id="__span-40-9"><span class="c1">// Ensure that only one of these streams is available</span>
</span><span id="__span-40-10"><span class="n">RET_CHECK</span><span class="p">(</span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">Inputs</span><span class="p">().</span><span class="n">HasTag</span><span class="p">(</span><span class="n">kNormPalmRectTag</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-40-11"><span class="w">          </span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">Inputs</span><span class="p">().</span><span class="n">HasTag</span><span class="p">(</span><span class="n">kRectPalmTag</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-40-12"><span class="w">          </span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">Inputs</span><span class="p">().</span><span class="n">HasTag</span><span class="p">(</span><span class="n">kNormPalmRectsTag</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-40-13"><span class="w">          </span><span class="n">cc</span><span class="o">-&gt;</span><span class="n">Inputs</span><span class="p">().</span><span class="n">HasTag</span><span class="p">(</span><span class="n">kRectsPalmTag</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span>
</span><span id="__span-40-14"><span class="w">          </span><span class="mi">1</span><span class="p">);</span>
</span></code></pre></div>
<h5 id="open">Open</h5>
<blockquote>
<p>After a graph starts, the framework calls Open(). The input side packets are available to the calculator at this
point.
Open() interprets the node configuration operations (see <a href="https://ai.google.dev/edge/mediapipe/framework/framework_concepts/graphs.md">Graphs</a>) and prepares the calculator's per-graph-run
state. This
function may also write packets to calculator outputs. An error during Open() can terminate the graph
run. <a href="https://ai.google.dev/edge/mediapipe/framework/framework_concepts/calculators">source</a></p>
</blockquote>
<h5 id="process">Process</h5>
<blockquote>
<p>For a calculator with inputs, the framework calls Process() repeatedly whenever at least one input stream has a packet
available. The framework by default guarantees that all inputs have the same timestamp (see <a href="https://ai.google.dev/edge/mediapipe/framework/framework_concepts/synchronization">Synchronization</a> for
more information). Multiple Process() calls can be invoked simultaneously when parallel execution is enabled. If an
error occurs during Process(), the framework calls Close() and the graph run terminates. <a href="https://ai.google.dev/edge/mediapipe/framework/framework_concepts/graphs.md">source</a></p>
</blockquote>
<p>This is where the bulk of the calculator's work is done. Inputs are read, calculations are done, and the results are
added to the output streams.</p>
<h5 id="close">Close</h5>
<blockquote>
<p>After all calls to Process() finish or when all input streams close, the framework calls Close(). This function is
always called if Open() was called and succeeded and even if the graph run terminated because of an error. No inputs
are available via any input streams during Close(), but it still has access to input side packets and therefore may
write outputs. After Close() returns, the calculator should be considered a dead node. The calculator object is
destroyed as soon as the graph finishes running. <a href="https://ai.google.dev/edge/mediapipe/framework/framework_concepts/graphs.md">source</a></p>
</blockquote>
<p>In general, the default version of this function will suffice, and there is little need to implement an overloaded
version.</p>
<h3 id="pluginhpp">plugin.hpp</h3>
<p>The actual plugin should be split into two files, to aid in readability, a header and the code itself. The plugin should
follow the general <a href="../writing_your_plugin/">guidelines</a>. Due to the way the mediapipe graphs work you may find it necessary to create two
plugins: one for sending the input to the graph, and one to get the results once the graph has run. To aid in
understanding, we will refer to the plugin that sends the input to the graph as <strong>Input</strong> and the other as <strong>Publish</strong>.
In this instance both plugins can be defined in the same header and code files. There are other plugins that use this
style as well, which you can use for reference (zed, and hand_tracking).</p>
<p>In the two plugin case <strong>Input</strong> can inherit from <a href="../../api/classILLIXR_1_1plugin/">plugin</a> or <a href="../../api/classILLIXR_1_1threadloop/">threadloop</a>, depending on your needs. However,
<strong>Publish</strong> should inherit from <a href="../../api/classILLIXR_1_1threadloop/">threadloop</a>. Below is some stub code for the headers.</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-41-1"><span class="k">class</span><span class="w"> </span><span class="nc">MyPublisher</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">threadloop</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-2"><span class="k">public</span><span class="o">:</span>
</span><span id="__span-41-3"><span class="w">    </span><span class="n">MyPublisher</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">name_</span><span class="p">,</span><span class="w"> </span><span class="n">phonebook</span><span class="o">*</span><span class="w"> </span><span class="n">pb_</span><span class="p">);</span>
</span><span id="__span-41-4"><span class="w">    </span><span class="o">~</span><span class="n">MyPublisher</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
</span><span id="__span-41-5">
</span><span id="__span-41-6"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">set_poller</span><span class="p">(</span><span class="n">mediapipe</span><span class="o">::</span><span class="n">OutputStreamPoller</span><span class="o">*</span><span class="w"> </span><span class="n">plr</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="n">_poller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plr</span><span class="p">;}</span>
</span><span id="__span-41-7"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">stop</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
</span><span id="__span-41-8"><span class="k">protected</span><span class="o">:</span>
</span><span id="__span-41-9"><span class="w">    </span><span class="n">skip_option</span><span class="w"> </span><span class="n">_p_should_skip</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
</span><span id="__span-41-10"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">_p_one_iterarion</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
</span><span id="__span-41-11"><span class="k">private</span><span class="o">:</span>
</span><span id="__span-41-12"><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">switchboard</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_switchboard</span><span class="p">;</span>
</span><span id="__span-41-13"><span class="w">    </span><span class="n">switchboard</span><span class="o">::</span><span class="n">writer</span><span class="o">&lt;</span><span class="n">my_data</span><span class="o">&gt;</span><span class="w">       </span><span class="n">_my_publisher</span><span class="p">;</span>
</span><span id="__span-41-14"><span class="w">    </span><span class="n">mediapipe</span><span class="o">::</span><span class="n">OutputStreamPoller</span><span class="o">*</span><span class="w">     </span><span class="n">_poller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
</span><span id="__span-41-15"><span class="w">    </span><span class="n">mediapipe</span><span class="o">::</span><span class="n">Packet</span><span class="w">                  </span><span class="n">_packet</span><span class="p">;</span>
</span><span id="__span-41-16"><span class="p">};</span>
</span><span id="__span-41-17">
</span><span id="__span-41-18"><span class="k">class</span><span class="w"> </span><span class="nc">MyInput</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">plugin</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-41-19"><span class="k">public</span><span class="o">:</span>
</span><span id="__span-41-20"><span class="w">    </span><span class="n">MyInput</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">name_</span><span class="p">,</span><span class="w"> </span><span class="n">phonebook</span><span class="o">*</span><span class="w"> </span><span class="n">pb_</span><span class="p">);</span>
</span><span id="__span-41-21"><span class="w">    </span><span class="o">~</span><span class="n">MyInput</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
</span><span id="__span-41-22">
</span><span id="__span-41-23"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">start</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
</span><span id="__span-41-24"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">switchboard</span><span class="o">::</span><span class="n">ptr</span><span class="o">&lt;</span><span class="n">data_type</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">frame</span><span class="p">);</span><span class="w">  </span><span class="c1">// this is the function that is called when an result from the graph is available </span>
</span><span id="__span-41-25"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">stop</span><span class="p">()</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
</span><span id="__span-41-26"><span class="k">private</span><span class="o">:</span>
</span><span id="__span-41-27"><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">switchbaord</span><span class="o">&gt;</span><span class="w"> </span><span class="n">_switchboard</span><span class="p">;</span>
</span><span id="__span-41-28"><span class="w">    </span><span class="n">mediapipe</span><span class="o">::</span><span class="n">CalculatorGraph</span><span class="w"> </span><span class="n">_graph</span><span class="p">;</span>
</span><span id="__span-41-29"><span class="w">    </span><span class="n">MyPublisher</span><span class="w"> </span><span class="n">_publisher</span><span class="p">;</span><span class="w">    </span><span class="c1">// this plugin will control the publisher</span>
</span><span id="__span-41-30"><span class="p">};</span>
</span></code></pre></div>
<h3 id="plugincpp">plugin.cpp</h3>
<p>Here we will go through the basic code needed to interface with the graph, based on the header code from above. At the
top you should define the streams that the plugin will send and receive from. These names must match those in the graph
file.</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-42-1"><span class="k">constexpr</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">kInputStream</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;input_video&quot;</span><span class="p">;</span><span class="w">     </span><span class="c1">// stream the Input will write to</span>
</span><span id="__span-42-2"><span class="k">constexpr</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">kImageDataTag</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;image_data&quot;</span><span class="p">;</span><span class="w">     </span><span class="c1">// stream the Input will write to</span>
</span><span id="__span-42-3"><span class="k">constexpr</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="n">kOutputStream</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;illixr_data&quot;</span><span class="p">;</span><span class="w">    </span><span class="c1">// stream the Publish will read from</span>
</span></code></pre></div>
<h4 id="input">Input</h4>
<p>The constructor should initialize the normal plugin stuff as well as the graph and <strong>Publish</strong> class.</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-43-1"><span class="n">MyInput</span><span class="o">::</span><span class="n">MyInput</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">name_</span><span class="p">,</span><span class="w"> </span><span class="n">phonebook</span><span class="o">*</span><span class="w"> </span><span class="n">pb_</span><span class="p">)</span><span class="w"> </span>
</span><span id="__span-43-2"><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">plugin</span><span class="p">{</span><span class="n">name_</span><span class="p">,</span><span class="w"> </span><span class="n">pb_</span><span class="p">}</span>
</span><span id="__span-43-3"><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">_switchbaord</span><span class="p">{</span><span class="n">pb_</span><span class="o">-&gt;</span><span class="n">lookup_impl</span><span class="o">&lt;</span><span class="n">switchboard</span><span class="o">&gt;</span><span class="p">()}</span>
</span><span id="__span-43-4"><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">_graph</span><span class="p">{</span><span class="n">mediapipe</span><span class="o">::</span><span class="n">CalculatorGraph</span><span class="p">()}</span>
</span><span id="__span-43-5"><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">_publisher</span><span class="p">{</span><span class="s">&quot;my_publisher&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pb_</span><span class="p">}</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-6"><span class="w">    </span><span class="o">&lt;</span><span class="n">any</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">need</span><span class="o">&gt;</span>
</span><span id="__span-43-7"><span class="p">}</span>
</span></code></pre></div>
<p>The <code>start</code> function should configure the graph, and start the <strong>PUBLISH</strong> plugin.</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-44-1"><span class="kt">void</span><span class="w"> </span><span class="nf">MyInput::start</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-2"><span class="w">    </span><span class="c1">// start the plugin</span>
</span><span id="__span-44-3"><span class="w">    </span><span class="n">plugin</span><span class="o">::</span><span class="n">start</span><span class="p">();</span>
</span><span id="__span-44-4"><span class="w">    </span><span class="c1">// read the environment variable which holds the graph configuration file name</span>
</span><span id="__span-44-5"><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">calculator_graph_config_contents</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-44-6"><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;mediapipe/hand_tracking_desktop_live.pbtxt&quot;</span>
</span><span id="__span-44-7"><span class="w">            </span><span class="p">;</span><span class="w">  </span><span class="c1">// NOLINT(whitespace/semicolon)</span>
</span><span id="__span-44-8"><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mediapipe</span><span class="o">::</span><span class="n">ParseTextProtoOrDie</span><span class="o">&lt;</span><span class="n">mediapipe</span><span class="o">::</span><span class="n">CalculatorGraphConfig</span><span class="o">&gt;</span><span class="p">(</span><span class="n">calculator_graph_config_contents</span><span class="p">);</span>
</span><span id="__span-44-9"><span class="w">    </span><span class="n">absl</span><span class="o">::</span><span class="n">Status</span><span class="w"> </span><span class="n">status</span><span class="p">;</span>
</span><span id="__span-44-10"><span class="w">    </span><span class="c1">// initialize the graph</span>
</span><span id="__span-44-11"><span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_graph</span><span class="p">.</span><span class="n">Initialize</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
</span><span id="__span-44-12"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">status</span><span class="p">.</span><span class="n">ok</span><span class="p">())</span>
</span><span id="__span-44-13"><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="n">status</span><span class="p">.</span><span class="n">message</span><span class="p">()));</span>
</span><span id="__span-44-14">
</span><span id="__span-44-15"><span class="w">    </span><span class="c1">// get a poller for the output stream</span>
</span><span id="__span-44-16"><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">status_or_poller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_graph</span><span class="p">.</span><span class="n">AddOutputStreamPoller</span><span class="p">(</span><span class="n">kOutputStream</span><span class="p">);</span>
</span><span id="__span-44-17"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">status_or_poller</span><span class="p">.</span><span class="n">ok</span><span class="p">())</span>
</span><span id="__span-44-18"><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;Error with output poller&quot;</span><span class="p">);</span>
</span><span id="__span-44-19"><span class="w">    </span><span class="c1">// pass the poller to the publisher</span>
</span><span id="__span-44-20"><span class="w">    </span><span class="n">_publisher</span><span class="p">.</span><span class="n">set_poller</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">mediapipe</span><span class="o">::</span><span class="n">OutputStreamPoller</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">status_or_poller</span><span class="p">).</span><span class="n">value</span><span class="p">()));</span>
</span><span id="__span-44-21">
</span><span id="__span-44-22"><span class="w">    </span><span class="c1">// start the graph</span>
</span><span id="__span-44-23"><span class="w">    </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_graph</span><span class="p">.</span><span class="n">StartRun</span><span class="p">({});</span>
</span><span id="__span-44-24"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">status</span><span class="p">.</span><span class="n">ok</span><span class="p">())</span>
</span><span id="__span-44-25"><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;Error starting graph&quot;</span><span class="p">);}</span>
</span><span id="__span-44-26">
</span><span id="__span-44-27"><span class="w">    </span><span class="c1">// register  the process funtion to be called any time there is input from ILLIXR to be added to the graph stream</span>
</span><span id="__span-44-28"><span class="w">    </span><span class="c1">//  here &quot;data_type&quot; is the type of data expected from ILLIXR and &quot;input_name&quot; is the registered name of the topic (data source) </span>
</span><span id="__span-44-29"><span class="w">    </span><span class="n">_switchboard</span><span class="o">-&gt;</span><span class="n">schedule</span><span class="o">&lt;</span><span class="n">data</span><span class="w"> </span><span class="n">type</span><span class="o">&gt;</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;input_name&quot;</span><span class="p">,</span>
</span><span id="__span-44-30"><span class="w">                                      </span><span class="p">[</span><span class="k">this</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="n">switchboard</span><span class="o">::</span><span class="n">ptr</span><span class="o">&lt;</span><span class="k">const</span><span class="o">&lt;</span><span class="n">data_type</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">inp</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-31"><span class="w">                                             </span><span class="k">this</span><span class="o">-&gt;</span><span class="n">process</span><span class="p">(</span><span class="n">inp</span><span class="p">);</span>
</span><span id="__span-44-32"><span class="w">                                      </span><span class="p">});</span>
</span><span id="__span-44-33">
</span><span id="__span-44-34"><span class="w">    </span><span class="c1">// start the publisher thread</span>
</span><span id="__span-44-35"><span class="w">    </span><span class="n">_publisher</span><span class="p">.</span><span class="n">start</span><span class="p">();</span>
</span></code></pre></div>
<p>Note the way <code>calculator_graph_config_contents</code> is constructed. This takes the needed config file, which in mediapipe
was specified as an environment variable, and changes it to be hard coded, as the plugin will have a specific purpose,
it should not need to change. To be sure the included file is properly specified, the following will need to be done.</p>
<ol>
<li>edit the original config file to escape all existing quotation marks
   <div class="language-text highlight"><pre><span></span><code><span id="__span-45-1">input_stream: &quot;image_data&quot;
</span></code></pre></div></li>
</ol>
<p>becomes</p>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-46-1">input_stream: \&quot;image_data\&quot;
</span></code></pre></div>
2. edit the original config file to enclose every line in quotation marks, adding a newline character to the end
   <div class="language-text highlight"><pre><span></span><code><span id="__span-47-1"># mediapipe/examples/desktop/hand_tracking:hand_tracking_cpu.
</span><span id="__span-47-2">
</span><span id="__span-47-3"># CPU image. (ImageFrame)
</span><span id="__span-47-4">input_stream: \&quot;input_video\&quot;
</span><span id="__span-47-5">input_stream: \&quot;image_data\&quot;
</span><span id="__span-47-6"># CPU image. (ImageFrame)
</span><span id="__span-47-7">output_stream: \&quot;illixr_data\&quot;
</span></code></pre></div></p>
<p>becomes</p>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-48-1">&quot;# mediapipe/examples/desktop/hand_tracking:hand_tracking_cpu.\n&quot;
</span><span id="__span-48-2">&quot;\n&quot;
</span><span id="__span-48-3">&quot;# CPU image. (ImageFrame)\n&quot;
</span><span id="__span-48-4">&quot;input_stream: \&quot;input_video\&quot;\n&quot;
</span><span id="__span-48-5">&quot;input_stream: \&quot;image_data\&quot;\n&quot;
</span><span id="__span-48-6">&quot;# CPU image. (ImageFrame)\n&quot;
</span><span id="__span-48-7">&quot;output_stream: \&quot;illixr_data\&quot;\n&quot;
</span><span id="__span-48-8">&quot;\n&quot;
</span></code></pre></div>
3. modify the <code>mediapipe/graphs/&lt;pipeline&gt;/build.cmake</code> to copy the file to the build directory
   <div class="language-cmake highlight"><pre><span></span><code><span id="__span-49-1"><span class="nb">file</span><span class="p">(</span><span class="s">COPY</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/hand_tracking_desktop_live.pbtxt</span>
</span><span id="__span-49-2"><span class="w">     </span><span class="s">DESTINATION</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="o">}</span><span class="s">/mediapipe</span>
</span><span id="__span-49-3"><span class="p">)</span>
</span></code></pre></div></p>
<hr />
<p>The <code>stop</code> function should also stop the publisher thread.</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-50-1"><span class="kt">void</span><span class="w"> </span><span class="nf">MyInput::stop</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-50-2"><span class="w">    </span><span class="c1">// Close any open mediapipe::CalculatorGraph instances</span>
</span><span id="__span-50-3"><span class="w">    </span><span class="c1">// with CloseAllPacketSources();</span>
</span><span id="__span-50-4"><span class="w">    </span><span class="c1">// and delete if necessary</span>
</span><span id="__span-50-5"><span class="w">    </span><span class="n">_publisher</span><span class="p">.</span><span class="n">stop</span><span class="p">();</span>
</span><span id="__span-50-6"><span class="w">    </span><span class="n">plugin</span><span class="o">::</span><span class="n">stop</span><span class="p">();</span>
</span><span id="__span-50-7"><span class="p">}</span>
</span></code></pre></div>
<hr />
<p>The <code>process</code> function will be called by the <code>switchboard</code> any time data of the expected type <code>data type</code> from topic
<code>input_name</code> is available.</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-51-1"><span class="kt">void</span><span class="w"> </span><span class="nf">MyInput::process</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">switchboard</span><span class="o">::</span><span class="n">ptr</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">data_type</span><span class="o">&gt;&amp;</span><span class="w"> </span><span class="n">frame</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-51-2"><span class="w">    </span><span class="c1">// read from the input and do whatever is needed to convert it to the input type for the graph</span>
</span><span id="__span-51-3"><span class="w">    </span><span class="c1">// in this example we are assuming that it can be simply converted</span>
</span><span id="__span-51-4"><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">in_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mediapipe_data_type</span><span class="p">(</span><span class="n">frame</span><span class="p">);</span>
</span><span id="__span-51-5">
</span><span id="__span-51-6"><span class="w">    </span><span class="c1">// generate a timestamp for the mediapipe packet</span>
</span><span id="__span-51-7"><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">frame_timestamp_us</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">high_resolution_clock</span><span class="o">::</span><span class="n">now</span><span class="p">().</span><span class="n">time_since_epoch</span><span class="p">().</span><span class="n">count</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="p">;</span>
</span><span id="__span-51-8"><span class="w">    </span><span class="c1">// wrap the data in a unique pointer</span>
</span><span id="__span-51-9"><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">data_ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">absl</span><span class="o">::</span><span class="n">make_unique</span><span class="o">&lt;</span><span class="n">mediapipe_data_type</span><span class="o">&gt;</span><span class="p">(</span><span class="n">in_data</span><span class="p">);</span>
</span><span id="__span-51-10"><span class="w">    </span><span class="c1">// add the data to the input stream of the graph</span>
</span><span id="__span-51-11"><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_graph</span><span class="p">.</span><span class="n">AddPacketToInputStream</span><span class="p">(</span><span class="n">kOutputStream</span><span class="p">,</span>
</span><span id="__span-51-12"><span class="w">                                              </span><span class="n">mediapipe</span><span class="o">::</span><span class="n">Adopt</span><span class="p">(</span><span class="n">img_ptr</span><span class="p">.</span><span class="n">release</span><span class="p">()).</span><span class="n">At</span><span class="p">(</span>
</span><span id="__span-51-13"><span class="w">                                                  </span><span class="n">mediapipe</span><span class="o">::</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">frame_timestamp_us</span><span class="p">)));</span>
</span><span id="__span-51-14"><span class="w">    </span><span class="c1">// raise an exception if something went wrong</span>
</span><span id="__span-51-15"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">stat</span><span class="p">.</span><span class="n">ok</span><span class="p">())</span>
</span><span id="__span-51-16"><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">(</span><span class="n">stat</span><span class="p">.</span><span class="n">message</span><span class="p">()));</span>
</span><span id="__span-51-17"><span class="p">}</span>
</span></code></pre></div>
<h4 id="publisher">Publisher</h4>
<p>The <strong>Publish</strong> constructor should initialize the writer which is used to put data into ILLIXR.</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-52-1"><span class="n">MyPublisher</span><span class="o">::</span><span class="n">MyPublisher</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span><span class="w"> </span><span class="n">name_</span><span class="w"> </span><span class="n">phonebook</span><span class="o">*</span><span class="w"> </span><span class="n">pb_</span><span class="p">)</span>
</span><span id="__span-52-2"><span class="w">        </span><span class="o">:</span><span class="w"> </span><span class="n">threadloop</span><span class="p">{</span><span class="n">name_</span><span class="p">,</span><span class="w"> </span><span class="n">pb_</span><span class="p">}</span>
</span><span id="__span-52-3"><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">_switchboard</span><span class="p">{</span><span class="n">pb_</span><span class="o">-&gt;</span><span class="n">lookup_impl</span><span class="o">&lt;</span><span class="n">switchboard</span><span class="o">&gt;</span><span class="p">()}</span>
</span><span id="__span-52-4"><span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="n">_my_publisher</span><span class="p">{</span><span class="n">_switchboard</span><span class="o">-&gt;</span><span class="n">get_writer</span><span class="o">&lt;</span><span class="n">my_data</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;data&quot;</span><span class="p">)}</span><span class="w"> </span><span class="p">{}</span>
</span></code></pre></div>
<p>Here <code>my_data</code> is the data type being written out and <code>data</code> is the name of the topic doing the writing.</p>
<hr />
<p>The stop function should clean up any poller instances</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-53-1"><span class="kt">void</span><span class="w"> </span><span class="nf">MyPublisher::stop</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-53-2"><span class="w">    </span><span class="k">delete</span><span class="w"> </span><span class="n">_poller</span><span class="p">;</span>
</span><span id="__span-53-3"><span class="w">    </span><span class="n">_poller</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
</span><span id="__span-53-4"><span class="p">}</span>
</span></code></pre></div>
<hr />
<p>The destructor should at least get rid of the poller.</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-54-1"><span class="n">MyPublisher</span><span class="o">::~</span><span class="n">MyPublisher</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-54-2"><span class="w">    </span><span class="k">delete</span><span class="w"> </span><span class="n">_poller</span><span class="p">;</span><span class="w">  </span><span class="c1">// ok to delete even if nullptr</span>
</span><span id="__span-54-3"><span class="p">}</span>
</span></code></pre></div>
<hr />
<p>We use the <code>_p_should_skip</code> to see if there is an output packet from the graph.</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-55-1"><span class="n">skip_option</span><span class="w"> </span><span class="nf">MyPublisher::_p_should_skip</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-2"><span class="w">    </span><span class="c1">// check to see if there is a new packet, and if so put it in the class variable and signal that _p_one_iteration should be run</span>
</span><span id="__span-55-3"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_poller</span><span class="o">-&gt;</span><span class="n">Next</span><span class="p">(</span><span class="o">&amp;</span><span class="n">_packet</span><span class="p">))</span>
</span><span id="__span-55-4"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">threadloop</span><span class="o">::</span><span class="n">skip_option</span><span class="o">::</span><span class="n">run</span><span class="p">;</span>
</span><span id="__span-55-5"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">threadloop</span><span class="o">::</span><span class="n">skip_option</span><span class="o">::</span><span class="n">skip_and_spin</span><span class="p">;</span><span class="w">   </span><span class="c1">// no new packet</span>
</span><span id="__span-55-6"><span class="p">}</span>
</span></code></pre></div>
<hr />
<p>The <code>_p_one_iteration</code> function will be called every time <code>_p_should_skip</code> returns <code>run</code>. This function will get the
output packet from the graph, manipulate the data if necessary, and write the results to ILLIXR.</p>
<div class="language-Cpp highlight"><pre><span></span><code><span id="__span-56-1"><span class="kt">void</span><span class="w"> </span><span class="nf">MyPublisher::_p_one_iterarion</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-2"><span class="w">    </span><span class="c1">// get the graph output</span>
</span><span id="__span-56-3"><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">new_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_packet</span><span class="p">.</span><span class="n">Get</span><span class="o">&lt;</span><span class="n">mediapipe_output</span><span class="o">&gt;</span><span class="p">();</span>
</span><span id="__span-56-4">
</span><span id="__span-56-5"><span class="w">    </span><span class="c1">// manipulate the data</span>
</span><span id="__span-56-6"><span class="w">    </span><span class="c1">// in this example we are assuming the data can be converted via constructor</span>
</span><span id="__span-56-7">
</span><span id="__span-56-8"><span class="w">    </span><span class="c1">// write the data to ILLIXR</span>
</span><span id="__span-56-9"><span class="w">    </span><span class="n">_my_publisher</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="n">_my_publisher</span><span class="p">.</span><span class="n">allocate</span><span class="o">&lt;</span><span class="n">my_data</span><span class="o">&gt;</span><span class="p">(</span><span class="n">my_data</span><span class="p">{</span><span class="n">new_data</span><span class="p">}));</span>
</span><span id="__span-56-10"><span class="p">}</span>
</span></code></pre></div>
<p>That is the basic code for what is needed to connect ILLIXR to a mediapipe tool.</p>
<h3 id="cmakeliststxt">CMakeLists.txt</h3>
<p>Now we will bring it all together in the <code>CMakeLists.txt</code> file in the mediapipe directory. This file will generate a
list of all source files and protobuf targets needed to compile the mediapipe part of the plugin. This file is called by
<code>add_subdirectory</code> from the main <code>CMakeLists.txt</code> file. The first section of this file will list all the protobuf
targets we need (those we generated via <code>protobuf_generate_obj</code> in <code>protobuf.cmake</code> files).</p>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-57-1"><span class="nb">target_sources</span><span class="p">(</span><span class="o">${</span><span class="nv">PLUGIN_NAME</span><span class="o">}</span><span class="w"> </span><span class="s">PUBLIC</span>
</span><span id="__span-57-2"><span class="w">               </span><span class="c"># list every protobuf target, one on each line</span>
</span><span id="__span-57-3"><span class="w">               </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:calculators.util.annotation_overlay_calculator_proto</span><span class="o">&gt;</span>
</span><span id="__span-57-4"><span class="w">               </span><span class="s">.</span>
</span><span id="__span-57-5"><span class="w">               </span><span class="s">.</span>
</span><span id="__span-57-6"><span class="w">               </span><span class="s">.</span>
</span><span id="__span-57-7"><span class="p">)</span>
</span></code></pre></div>
<p>Next we add targets that were generated by turning graph files into binary.</p>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-58-1"><span class="nb">target_sources</span><span class="p">(</span><span class="o">${</span><span class="nv">PLUGIN_NAME</span><span class="o">}</span><span class="w"> </span><span class="s">PUBLIC</span>
</span><span id="__span-58-2"><span class="w">               </span><span class="o">$&lt;</span><span class="nv">TARGET_OBJECTS:hand_renderer_cpu_linked</span><span class="o">&gt;</span>
</span><span id="__span-58-3"><span class="w">               </span><span class="s">.</span>
</span><span id="__span-58-4"><span class="w">               </span><span class="s">.</span>
</span><span id="__span-58-5"><span class="w">               </span><span class="s">.</span>
</span><span id="__span-58-6"><span class="p">)</span>
</span></code></pre></div>
<p>Next <code>include</code> each of the subdirectories.</p>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-59-1"><span class="nb">include</span><span class="p">(</span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/calculators/build.cmake</span><span class="p">)</span>
</span><span id="__span-59-2"><span class="nb">include</span><span class="p">(</span><span class="o">${</span><span class="nv">CMAKE_CURRENT_LIST_DIR</span><span class="o">}</span><span class="s">/framework/build.cmake</span><span class="p">)</span>
</span><span id="__span-59-3"><span class="err">.</span>
</span><span id="__span-59-4"><span class="err">.</span>
</span><span id="__span-59-5"><span class="err">.</span>
</span></code></pre></div>
<p>Next add any include directories. In case there are multiple versions of protobuf on the system, we want to make sure
that the correct one is picked up by the compiler, so we prepend it to the includes.</p>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-60-1"><span class="nb">target_include_directories</span><span class="p">(</span><span class="o">${</span><span class="nv">PLUGIN_NAME</span><span class="o">}</span><span class="w"> </span><span class="s">BEFORE</span><span class="w"> </span><span class="s">PUBLIC</span><span class="w"> </span><span class="o">${</span><span class="nv">Protobuf_INCLUDE_DIRS</span><span class="o">}</span><span class="p">)</span>
</span><span id="__span-60-2"><span class="nb">target_include_directories</span><span class="p">(</span><span class="o">${</span><span class="nv">PLUGIN_NAME</span><span class="o">}</span><span class="w"> </span><span class="s">PUBLIC</span>
</span><span id="__span-60-3"><span class="w">                           </span><span class="o">${</span><span class="nv">CMAKE_BINARY_DIR</span><span class="o">}</span><span class="w">  </span><span class="c"># picks up protobuf generated headers</span>
</span><span id="__span-60-4"><span class="w">                           </span><span class="o">${</span><span class="nv">CMAKE_SOURCE_DIR</span><span class="o">}</span><span class="w">  </span><span class="c"># picks up any normal mediapipe headers</span>
</span><span id="__span-60-5"><span class="w">                           </span><span class="s">.</span><span class="w">                    </span><span class="c"># any other includes</span>
</span><span id="__span-60-6"><span class="w">                           </span><span class="s">.</span>
</span><span id="__span-60-7"><span class="w">                           </span><span class="s">.</span>
</span><span id="__span-60-8"><span class="w">                           </span><span class="o">${</span><span class="nv">CMAKE_INSTALL_PREFIX</span><span class="o">}</span><span class="s">/include</span><span class="w">  </span><span class="c"># any headers installed by ILLIXR</span>
</span><span id="__span-60-9"><span class="p">)</span>
</span></code></pre></div>
<p>Lastly, add the libraries to link against.</p>
<div class="language-cmake highlight"><pre><span></span><code><span id="__span-61-1"><span class="nb">target_link_libraries</span><span class="p">(</span><span class="o">${</span><span class="nv">PLUGIN_NAME</span><span class="o">}</span><span class="w"> </span><span class="s">PUBLIC</span>
</span><span id="__span-61-2"><span class="w">                      </span><span class="s">protobuf::libprotobuf</span>
</span><span id="__span-61-3"><span class="w">                      </span><span class="s">absl::base</span><span class="w">            </span><span class="c"># there will likely be a lot of absl libraries</span>
</span><span id="__span-61-4"><span class="w">                      </span><span class="s">.</span>
</span><span id="__span-61-5"><span class="w">                      </span><span class="s">.</span>
</span><span id="__span-61-6"><span class="w">                      </span><span class="s">.</span>
</span><span id="__span-61-7"><span class="p">)</span>
</span></code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.suggest", "content.code.annotate", "content.footnote.tooltips", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../js/jquery.min.js"></script>
      
        <script src="../../js/clipboard.min.js"></script>
      
        <script src="../../js/code-box-copy.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": false, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "zoom"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>